<!DOCTYPE html>
<html lang="en"><head>
<script src="chapter_iv_files/libs/clipboard/clipboard.min.js"></script>
<script src="chapter_iv_files/libs/quarto-html/tabby.min.js"></script>
<script src="chapter_iv_files/libs/quarto-html/popper.min.js"></script>
<script src="chapter_iv_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="chapter_iv_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chapter_iv_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="chapter_iv_files/libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.41">

  <title>FMB819: R을 이용한 데이터분석</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="chapter_iv_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="chapter_iv_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="chapter_iv_files/libs/revealjs/dist/theme/quarto-2f366650f320edcfcf53d73c80250a32.css">
  <link rel="stylesheet" href="default">
  <link rel="stylesheet" href="../css/kubs.css">
  <link rel="stylesheet" href="../css/kubs-fonts.css">
  <link href="chapter_iv_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="chapter_iv_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="chapter_iv_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="chapter_iv_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="chapter_iv_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="chapter_iv_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="chapter_iv_files/libs/countdown/countdown.css" rel="stylesheet">

  <script src="chapter_iv_files/libs/countdown/countdown.js"></script>

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">FMB819: R을 이용한 데이터분석</h1>
  <p class="subtitle"><span style="font-size:1.5em; color:#a01616;">Instrumental Variables</span></p>

<div class="quarto-title-authors">
</div>

</section>
<section id="todays-agenda" class="slide level2">
<h2>Today’s Agenda</h2>
<ul>
<li><p>도구변수 <em>instrumental variables</em> (IV)</p></li>
<li><p>John Snow’s 연구: 1850년 영국 런던 …</p></li>
<li><p>IV estimator란?</p></li>
<li><p>2단계 최소좌승법 (Two Stage Least Squares)</p></li>
<li><p>약한 도구변수 (Weak Instruments)</p></li>
</ul>
</section>
<section id="배경" class="slide level2">
<h2>배경</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>책의 <a href="https://scpoecon.github.io/ScPoEconometrics/causality.html">7장</a>, <a href="https://scpoecon.github.io/ScPoEconometrics/STAR.html">8장</a>, <a href="https://scpoecon.github.io/ScPoEconometrics/RDD.html">9장</a> 및 입문 과정에서 <strong>실험적 방법(experimental methods)</strong>의 장점에 대해 논의함.</p></li>
<li><p>무작위 대조 실험(Randomized Control Trials, RCT) 또는 <strong>준실험적(Quasi-experimental) 방법</strong>(무작위 할당과 유사한 상황)은 <strong>인과 효과(causal effects)</strong>를 추정할 수 있도록 도와줌.</p></li>
<li><p>특히, <a href="https://scpoecon.github.io/ScPoEconometrics/causality.html#rct">RCT</a>에 대해 이미 익숙할 것임.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><p>만약 개인이 처치를 받을지 여부를 <strong>통제할 수 있다면</strong>, <em>선택 편향(selection bias)</em>이 발생할 수 있음.</p></li>
<li><p>RCT는 무작위 할당을 통해 <strong>자가 선택(self-selection)</strong> 문제를 해결함.</p></li>
<li><p>따라서 <strong>실험 데이터</strong>가 있다면 좋은 해결책이 존재함.</p></li>
<li><p>그렇다면 <strong>비실험 데이터(non-experimental data)</strong>는 어떻게 분석해야 할까?</p></li>
</ul>
</div></div>
</section>
<section id="비실험-데이터-non-experimental-data" class="slide level2">
<h2>비실험 데이터 (Non-Experimental Data)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><strong>누락된 변수 편향(omitted variable bias)</strong>에 대해 논의한 바 있음.</p></li>
<li><p>오차항 <span class="math inline">\(u\)</span>에 포함된 변수 <span class="math inline">\(x_2\)</span>와 설명 변수 <span class="math inline">\(x_1\)</span> 사이에 상관관계가 존재한다면 어떻게 될까?</p></li>
<li><p>우리는 <span class="math inline">\(x_1\)</span>의 효과와 <span class="math inline">\(x_2\)</span>의 효과를 분리할 수 없기 때문에 <strong>편향된 추정치</strong>를 얻게 됨.</p></li>
<li><p>이러한 편향이 너무 심하면 <strong>효과의 방향(부호)조차 잘못 추정할 수 있음</strong>.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/dag1-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<ul>
<li><strong>IV</strong> 는 OVB로 인한 문제를 해결한다.</li>
</ul>
</section>
<section id="년-런던-켄싱턴의-빈민가" class="slide level2" data-background-image="../img/photos/Kensington_slums_large.jpg">
<h2><span style="color:white;">1850년 런던: 켄싱턴의 빈민가</span></h2>
</section>
<section id="존-스노우의-비실험-콜레라가-도시를-강타" class="slide level2">
<h2>존 스노우의 (비)실험: 콜레라가 도시를 강타</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>존 스노우(John Snow)는 1850년경 런던에서 활동한 의사로, 그 당시 도시에서는 <strong>콜레라가 여러 차례 창궐</strong>하였음.</p></li>
<li><p>당시 <strong>질병의 전파 방식</strong>에 대한 논쟁이 있었음: 공기를 통해 전염되는가, 아니면 물을 통해 전염되는가?</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../img/photos/father-thames.jpg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="section" class="slide level2" data-background-image="../img/photos/slum.jpg">
<h2></h2>
</section>
<section id="년의-의료-지식" class="slide level2" data-background-image="../img/photos/slum.jpg">
<h2><span style="color:white;">1850년의 의료 지식</span></h2>
<p><span style="color:white;">세균이 질병을 유발할 수 있다는 사실이 알려지지 않음.</span></p>
<p><span style="color:white;">현미경은 존재했지만, 해상도가 낮아 병원균을 명확히 볼 수 없었음.</span></p>
<p><span style="color:white;">대부분의 인간 병원균은 육안으로 관찰할 수 없음.</span></p>
<p><span style="color:white;">이른바 ‘감염 이론’(즉, <em>세균</em>에 의한 감염)이 일부 지지를 받았으나,</span></p>
<p><span style="color:white;">당시의 지배적인 이론은 질병이 <a href="https://en.wikipedia.org/wiki/Miasma_theory">미아스마</a>에 의해 발생한다는 것이었음.</span></p>
</section>
<section id="스노우의-탐정-활동" class="slide level2">
<h2>스노우의 탐정 활동</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>스노우는 방대한 데이터를 수집하였음.</p></li>
<li><p>1854년 발생한 콜레라 유행 시 <strong>사망자의 위치를 지도에 표시</strong>하였음.</p></li>
<li><p>이 사건이 바로 악명 높은 <strong>브로드스트리트 펌프(Broadstreet Pump) 사건</strong>임.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../img/photos/snow-map.jpg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="cholera-패키지" class="slide level2">
<h2><code>cholera</code> 패키지</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><code>cholera</code> 패키지는 존 스노우의 연구를 재현하는 흥미로운 기능을 포함하고 있음.</p></li>
<li><p>예를 들어, <strong>스노우의 지도(R 버전)</strong>를 생성할 수 있음:</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>cholera<span class="sc">::</span><span class="fu">snowMap</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-2-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="cholera-패키지의-기능" class="slide level2">
<h2><code>cholera</code> 패키지의 기능</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>또는 <strong>사례 번호 15번 환자의 이동 경로</strong>를 시각화할 수도 있음:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-3-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>혹은 <strong>펌프 주변 지역의 보로노이 다각형(Voronoi polygons)</strong>을 추정할 수도 있음:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-4-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="브로드-스트리트-펌프의-제거" class="slide level2">
<h2>브로드 스트리트 펌프의 제거?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>스노우는 <strong>브로드 스트리트 펌프(Broad Street Pump)</strong>가 원인이라고 지목함.</p></li>
<li><p>그는 <strong>펌프 손잡이를 제거할 것을 요청</strong>하였음.</p></li>
<li><p>하지만, 그는 이 조치가 <strong>유행병의 종식을 가져왔다는 점에 회의적이었음</strong>.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-5-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="런던의-상수도-공급-지도" class="slide level2">
<h2>런던의 상수도 공급 지도</h2>
<ul>
<li><p>런던의 <strong>상수도 공급원은 템스강(River Thames)이었음.</strong></p></li>
<li><p>각 상수도 회사는 <strong>다른 취수 지점(intake points)</strong>을 가졌음.</p></li>
<li><p><strong>사우스워크(Southwark) 및 복스홀(Vauxhall) 수자원 회사</strong>는 대형 하수 배출구 아래에서 취수를 하였음.</p></li>
<li><p><strong>램버스(Lambeth) 수자원 회사</strong>는 더 깨끗한 상류에서 취수를 하였음.</p></li>
</ul>
</section>
<section id="스노우의-결론" class="slide level2">
<h2>스노우의 결론</h2>
<ul>
<li>스노우가 수집한 데이터는 다음과 같음:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">area</th>
<th style="text-align: right;">numhouses</th>
<th style="text-align: right;">deaths</th>
<th style="text-align: right;">death1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Southwark and Vauxhall</td>
<td style="text-align: right;">40046</td>
<td style="text-align: right;">1263</td>
<td style="text-align: right;">315</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lambeth</td>
<td style="text-align: right;">26107</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rest of London</td>
<td style="text-align: right;">256423</td>
<td style="text-align: right;">1422</td>
<td style="text-align: right;">59</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>그리고 다음과 같은 결론을 내림:</li>
</ul>
<blockquote>
<p>만약 <strong>사우스워크 및 복스홀 수자원 회사가 취수 지점을 상류로 옮겨</strong> 램버스 수자원 회사와 같은 곳에서 물을 공급받았다면, <strong>약 1,000명의 목숨을 구할 수 있었을 것</strong>이다.</p>
</blockquote>
<ul>
<li>하지만 <strong>미아스마 이론의 지지자들</strong>은 여전히 이를 결정적인 증거로 받아들이지 않았음. 왜냐하면 <strong>이 지역의 나쁜 공기질을 유발하는 다른 요인들도 존재했기 때문</strong>임.</li>
</ul>
</section>
<section>
<section id="we-need-a-model." class="title-slide slide level1 center">
<h1>We Need A Model.</h1>

</section>
<section id="스노우의-콜레라-전파-모델" class="slide level2">
<h2>스노우의 콜레라 전파 모델</h2>
<ul>
<li><p>개인 <span class="math inline">\(i\)</span>가 콜레라로 사망하면 <span class="math inline">\(c_i = 1\)</span>, 그렇지 않으면 <span class="math inline">\(c_i = 0\)</span>로 정의함.</p></li>
<li><p><span class="math inline">\(w_i = 1\)</span>은 <span class="math inline">\(i\)</span>의 식수가 <strong>오염되었음을 의미</strong>하며, <span class="math inline">\(w_i = 0\)</span>은 깨끗한 물을 의미함.</p></li>
<li><p>당시 기술로는 작은 미생물을 감지할 수 없었음.</p></li>
<li><p><span class="math inline">\(u_i\)</span>는 개인 <span class="math inline">\(i\)</span>의 사망 확률에 영향을 미치는 <strong>관측되지 않는 요인</strong>(예: 가난, 거주 위치, 공기질, 유전적 특성 등)을 포함함.</p></li>
</ul>
<p>우리는 이를 다음과 같이 수식화할 수 있음:</p>
<p><span class="math display">\[
c_i = \alpha + \delta w_i + u_i
\]</span></p>
</section>
<section id="단순한-분석이-항상-옳은가" class="slide level2">
<h2>단순한 분석이 항상 옳은가?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>스노우는 자신의 데이터를 사용하여 <strong>깨끗한 물을 마시는 것과 콜레라 발생률 간의 상관관계</strong>를 평가할 수도 있었음.</p></li>
<li><p>즉, <span class="math inline">\(Cor(c_i, w_i)\)</span>를 측정할 수 있음.</p></li>
<li><p>만약 <span class="math inline">\(Cor(c_i, w_i) \approx 0.5\)</span>라면, 이는 감염 이론을 증명하는가?</p></li>
</ul>
</div><div class="column" style="width:50%;">
<blockquote>
<p>경제학자 <strong>앵거스 디턴(Angus Deaton)</strong>은 다음과 같이 지적함:</p>
<p>“오염된 물을 마신 사람들은 가난할 가능성이 더 높고, 다양한 방식으로 오염된 환경에 살고 있었으며, 당시 콜레라의 원인으로 여겨졌던 ’유독한 미아스마’에 더 많이 노출되었음.”</p>
</blockquote>
<p>☹️ 단순한 상관관계로는 충분하지 않음!</p>
</div></div>
</section>
<section id="단순-비교의-문제점" class="slide level2">
<h2>단순 비교의 문제점</h2>
<ul>
<li><p>깨끗한 물을 마시는 사람과 오염된 물을 마시는 사람을 <strong>단순 비교하는 것은 의미가 없음.</strong></p></li>
<li><p><strong>왜냐하면 모든 조건이 동일하지 않기 때문</strong>(<span class="math inline">\(all\ else\ is\ not\ equal\)</span>). 깨끗한 물을 마시는 것과 가난, 열악한 거주 환경, 나쁜 공기질 등이 <strong>밀접한 관련</strong>이 있음.</p></li>
<li><p>이는 OLS 추정을 위한 <strong>필수적인 직교성(orthogonality) 가정</strong>을 위반함:</p>
<p><span class="math display">\[E[u_i | w_i] \neq 0\]</span></p></li>
<li><p>또 다른 표현으로, <strong><span class="math inline">\(Cov(w_i, u_i) \neq 0\)</span></strong> 즉, <span class="math inline">\(w_i\)</span>는 <strong>내생적(endogenous)</strong> 변수임.</p></li>
<li><p>즉, <span class="math inline">\(u_i\)</span>에 포함된 요소들이 <span class="math inline">\(w_i\)</span>와 <span class="math inline">\(c_i\)</span> 모두에 영향을 미침.</p></li>
</ul>
</section>
<section id="스노우의-모델과-대수적-접근" class="slide level2">
<h2>스노우의 모델과 대수적 접근</h2>
<p>단순한 모델을 다시 떠올려 보자:</p>
<p><span class="math display">\[c_i = \alpha + \delta w_i + u_i\]</span></p>
<p>이제 <span class="math inline">\(w\)</span>의 두 가지 값에 따라 기대값을 계산하면,</p>
<p><span class="math display">\[\begin{align}
E[c_i | w_i = 1] &amp;= \alpha + \delta + E[u_i | w_i = 1] \\
E[c_i | w_i = 0] &amp;= \alpha + \phantom{\delta} + E[u_i | w_i = 0]
\end{align}\]</span></p>
<p>이 두 식을 빼면,</p>
<p><span class="math display">\[\begin{equation}
E[c_i | w_i = 1] - E[c_i | w_i = 0] = \delta + \left\{ E[u_i | w_i = 1] - E[u_i | w_i = 0]\right\}
\end{equation}\]</span></p>
<ul>
<li><p>마지막 항 ( { E[u_i | w_i = 1] - E[u_i | w_i = 0]} ) 은 <strong>0이 아님</strong> (디턴이 말한 것처럼!).</p></li>
<li><p>즉, <strong>회귀 분석을 통한 <span class="math inline">\(\delta\)</span> 추정치는 편향됨(biased).</strong></p></li>
</ul>
</section></section>
<section>
<section id="the-iv-estimator" class="title-slide slide level1 center">
<h1>The IV Estimator</h1>

</section>
<section id="존-스노우-왈" class="slide level2">
<h2>존 스노우 왈</h2>
<blockquote>
<p>“… 물 공급이 아주 복잡하게 섞여있다. 각 회사의 수도관은 모든 거리와 거의 모든 골목길과 후미진 곳까지 이어진다. …</p>
<p>이 실험은 매우 거대한 규모에서 진행되었다. 무려 30만 명이 넘는 사람들이 성별, 연령, 직업, 사회적 계층과 상관없이 두 개의 그룹으로 나뉘었다.</p>
<p>한 그룹은 런던의 하수를 포함하여 콜레라 환자들로부터 나온 모든 오염물을 포함할 가능성이 있는 물을 공급받았으며,</p>
<p>다른 그룹은 그런 오염물로부터 완전히 자유로운 물을 공급받았다.”</p>
</blockquote>
</section>
<section id="london-water-supply" class="slide level2" data-background-image="../img/photos/snow-supply.jpg">
<h2><span style="color:white;">London Water Supply</span></h2>
</section>
<section id="도구변수iv-제안" class="slide level2">
<h2>도구변수(IV) 제안</h2>
<ul>
<li>스노우는 <strong>도구변수(instrumental variable, IV)</strong> <span class="math inline">\(z_i\)</span>를 제안함. 이는 가구 <span class="math inline">\(i\)</span>에 물을 공급하는 <strong>수도 회사의 정체성</strong>임.</li>
</ul>
<p>더 형식적으로, 도구변수를 다음과 같이 정의할 수 있음:</p>
<p><span class="math display">\[\begin{align*}
z_i &amp;=  \begin{cases}
                    1 &amp; \text{if 물 공급자가 Lambeth일 경우} \\
                    0 &amp; \text{if 물 공급자가 Southwark 또는 Vauxhall일 경우} \\
                 \end{cases} \\
\end{align*}\]</span></p>
<ul>
<li><p><span class="math inline">\(z_i\)</span>는 <strong>식수의 순도</strong> <span class="math inline">\(w_i\)</span>와 높은 상관관계를 가짐.</p></li>
<li><p>하지만, <span class="math inline">\(z_i\)</span>는 우리가 이전에 우려했던 <strong><span class="math inline">\(u_i\)</span> 내의 다른 모든 요인들과는 상관관계가 없어 보임</strong>.</p>
<ul>
<li>물 공급은 <strong>수년 전에 결정</strong>되었으며,</li>
<li>같은 거리 내의 집들도 <strong>서로 다른 수도 공급자를 가질 수 있었음</strong>.</li>
</ul></li>
</ul>
</section>
<section id="simple-iv-in-a-dag" class="slide level2" data-background-image="../img/photos/IV-dag.png">
<h2><span style="color:black;">Simple IV in a DAG</span></h2>
<ul>
<li><span class="math inline">\(u\)</span>는 독립변수와 결과 모두 영향을 미침</li>
</ul>
</section>
<section id="iv-추정량의-정의" class="slide level2">
<h2>IV 추정량의 정의</h2>
<p>이제 단순한 <strong>IV 추정량</strong>을 정의할 준비가 되었음.</p>
<p>기존과 마찬가지로, <span class="math inline">\(z\)</span>의 값을 기준으로 조건부 기대값을 계산해보자:</p>
<p><span class="math display">\[\begin{align}
E[c_i | z_i = 1] &amp;= \alpha + \delta E[w_i | z_i = 1] + E[u_i | z_i = 1] \\
E[c_i | z_i = 0] &amp;= \alpha + \delta E[w_i | z_i = 0] + E[u_i | z_i = 0]
\end{align}\]</span></p>
<p>이 두 식을 빼면:</p>
<p><span class="math display">\[\begin{align}
E[c_i | z_i = 1] - E[c_i | z_i = 0] &amp;= \delta  \left\{ E[w_i | z_i = 1] - E[w_i | z_i = 0]\right\} \\
&amp;+ \underbrace{\left\{ E[u_i | z_i = 1] - E[u_i | z_i = 0] \right\}}_{=0 \text{ (독립성 가정에 의해)}}
\end{align}\]</span></p>
</section>
<section id="최종-iv-추정량" class="slide level2">
<h2>최종 IV 추정량</h2>
<ul>
<li>마지막으로, <strong>IV가 유효하다면</strong> (즉, <span class="math inline">\(E[w_i | z_i = 1] - E[w_i | z_i = 0] \neq 0\)</span>):</li>
</ul>
<p><span class="math display">\[\begin{equation}
\delta = \frac{E[c_i | z_i = 1] - E[c_i | z_i = 0]}{E[w_i | z_i = 1] - E[w_i | z_i = 0]} \tag{eq:IV}
\end{equation}\]</span></p>
<p>즉, IV 추정량은 결과 변수(<span class="math inline">\(c\)</span>)의 변화량을 도구변수(<span class="math inline">\(z\)</span>)가 유발하는 설명 변수(<span class="math inline">\(w\)</span>)의 변화량으로 나눈 값임.</p>
</section>
<section id="특수한-경우-월드wald-추정량" class="slide level2 scrollable">
<h2>특수한 경우: 월드(Wald) 추정량</h2>
<p><span class="math inline">\(x \mapsto y\)</span>는 <span class="math inline">\(x\)</span>가 <span class="math inline">\(y\)</span>의 추정치임을 의미한다고 하자:</p>
<ol type="1">
<li><span class="math inline">\(\overline{c}_1 \mapsto E[c_i | z_i = 1]\)</span>: Lambeth에서 공급받은 가구 중 콜레라에 걸린 비율.</li>
<li><span class="math inline">\(\overline{w}_1 \mapsto E[w_i | z_i = 1]\)</span>: Lambeth에서 공급받은 가구 중 오염된 물을 공급받은 비율.</li>
<li><span class="math inline">\(\overline{c}_0 \mapsto E[c_i | z_i = 0]\)</span>: Lambeth 외 지역에서 공급받은 가구 중 콜레라에 걸린 비율.</li>
<li><span class="math inline">\(\overline{w}_0 \mapsto E[w_i | z_i = 0]\)</span>: Lambeth 외 지역에서 공급받은 가구 중 오염된 물을 공급받은 비율.</li>
</ol>
<p>이 경우 추정량은 다음과 같음:</p>
<p><span class="math display">\[\begin{equation}
\hat{\delta} = \frac{\overline{c}_1 - \overline{c}_0}{\overline{w}_1 - \overline{w}_0}
\end{equation}\]</span></p>
<p>위의 모든 변수 <span class="math inline">\(c, w, z\)</span>가 <strong>이진(binary) 변수</strong>인 경우, 이 추정량은 <em>월드(Wald) 추정량</em>이라 불림.</p>
</section>
<section id="요약" class="slide level2 scrollable">
<h2>요약</h2>
<p>도구변수(IV)는 <strong>관찰 데이터만 있는 상황에서 인과 관계를 식별할 수 있는 강력한 도구</strong>임. 특히, 조건부 평균 가정(<span class="math inline">\(E[u_i | x_i] = 0\)</span>)이 위배될 가능성이 있는 경우, <strong>즉, <span class="math inline">\(x\)</span>가 내생적(endogenous)일 때</strong>, 이를 해결할 수 있음.</p>
<p>IV <span class="math inline">\(z\)</span>의 핵심 조건은 다음과 같음:</p>
<ol type="1">
<li><strong><span class="math inline">\(z\)</span>가 <span class="math inline">\(x\)</span>에 대해 관련성(relevance)을 가져야 함.</strong>
<ul>
<li>예를 들어, <span class="math inline">\(z\)</span>를 <span class="math inline">\(x\)</span>에 대한 단순 회귀 분석에 사용했을 때 예측력이 높아야 함.</li>
<li>데이터에서 <em>검증 가능한</em> 조건임.</li>
</ul></li>
<li><strong><span class="math inline">\(z\)</span>가 결과 변수에 영향을 미치는 다른 요인들과 무관하다는 이론적 근거가 필요함.</strong>
<ul>
<li>즉, <span class="math inline">\(z\)</span>는 <em>외생적(exogenous)</em>이어야 하며, <span class="math inline">\(E[u | z] = 0\)</span>이 성립해야 함.</li>
<li>이는 <strong>가정(assumption)</strong>이므로, 데이터로 직접 검증할 수 없음.</li>
</ul></li>
</ol>
</section>
<section id="패키지-소개-rayshader" class="slide level2">
<h2>패키지 소개 <a href="https://www.rayshader.com"><code>Rayshader</code></a></h2>
<ul>
<li>모든 종류의 elevation 데이터를 <code>raytracing</code>할 수 있음.</li>
<li>대부분의 ggplot 그래프를 3D로 변환할 수도 있음!</li>
</ul>
<video width="100%" height="50%" controls="" id="my_video">
<source src="https://www.tylermw.com/wp-content/uploads/2019/05/deathappended2.mp4" type="video/mp4">
</video>
</section>
<section id="패키지-소개-rayshader-1" class="slide level2">
<h2>패키지 소개 <a href="https://www.rayshader.com"><code>Rayshader</code></a></h2>
<ul>
<li>이렇게만 하면 됨</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href=""></a><span class="fu">library</span>(rayshader)</span>
<span id="cb2-3"><a href=""></a><span class="co">#Data from Social Security administration</span></span>
<span id="cb2-4"><a href=""></a>death <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"https://www.tylermw.com/data/death.csv"</span>, <span class="at">skip =</span> <span class="dv">1</span>)</span>
<span id="cb2-5"><a href=""></a>meltdeath <span class="ot">=</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(death, <span class="at">id.vars =</span> <span class="st">"Year"</span>)</span>
<span id="cb2-6"><a href=""></a></span>
<span id="cb2-7"><a href=""></a>meltdeath<span class="sc">$</span>age <span class="ot">=</span> <span class="fu">as.numeric</span>(meltdeath<span class="sc">$</span>variable)</span>
<span id="cb2-8"><a href=""></a></span>
<span id="cb2-9"><a href=""></a><span class="co"># make a ggplot</span></span>
<span id="cb2-10"><a href=""></a>deathgg <span class="ot">=</span> <span class="fu">ggplot</span>(meltdeath) <span class="sc">+</span></span>
<span id="cb2-11"><a href=""></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>Year,<span class="at">y=</span>age,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb2-12"><a href=""></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Year"</span>,<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">1900</span>,<span class="dv">2010</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb2-13"><a href=""></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Age"</span>,<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>),<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb2-14"><a href=""></a>  <span class="fu">scale_fill_viridis</span>(<span class="st">"Death</span><span class="sc">\n</span><span class="st">Probability</span><span class="sc">\n</span><span class="st">Per Year"</span>,</span>
<span id="cb2-15"><a href=""></a>       <span class="at">trans =</span> <span class="st">"log10"</span>,<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>), </span>
<span id="cb2-16"><a href=""></a>       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"1/10"</span>,<span class="st">"1/100"</span>,<span class="st">"1/1000"</span>,<span class="st">"1/10000"</span>)) <span class="sc">+</span></span>
<span id="cb2-17"><a href=""></a>  <span class="fu">ggtitle</span>(<span class="st">"Death Probability vs Age and Year for the USA"</span>) <span class="sc">+</span></span>
<span id="cb2-18"><a href=""></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Data Source: US Dept. of Social Security"</span>)</span>
<span id="cb2-19"><a href=""></a></span>
<span id="cb2-20"><a href=""></a><span class="co"># give it to rayshader</span></span>
<span id="cb2-21"><a href=""></a><span class="fu">plot_gg</span>(deathgg, <span class="at">multicore=</span><span class="cn">TRUE</span>,<span class="at">height=</span><span class="dv">5</span>,<span class="at">width=</span><span class="dv">6</span>,<span class="at">scale=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="교육과-수입의-관계" class="slide level2">
<h2>교육과 수입의 관계</h2>
<p><strong><em>학교 교육이 수입에 미치는 영향</em></strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>학교 교육이 수입에 미치는 인과적 영향은 무엇일까?</li>
<li><a href="https://en.wikipedia.org/wiki/Jacob_Mincer">제이콥 민서(Jacob Mincer)</a>는 이 중요한 질문을 연구하였음.</li>
<li>그가 제안한 모델은 다음과 같음:</li>
</ul>
<p><span class="math display">\[
\log Y_i = \alpha + \rho S_i + \beta_1 X_i + \beta_2 X_i^2 + e_i
\]</span></p>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-8-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="교육과-수입의-관계-분석" class="slide level2">
<h2>교육과 수입의 관계 분석</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
\log Y_i = \alpha + \rho S_i + \beta_1 X_i + \beta_2 X_i^2 + e_i
\]</span></p>
<ul>
<li>민서는 <span class="math inline">\(\rho\)</span> 값이 약 <strong>0.11</strong>이라는 결과를 발견함.</li>
<li>이는 <strong>추가적인 1년의 교육이 약 11%의 수입 증가와 관련</strong>이 있음을 의미함.</li>
<li>DAG(유향 인과 그래프)를 살펴보면, 이 모델이 적절한지 판단할 수 있음.</li>
<li>하지만 이 모델이 왜 문제가 있을 수 있는가?</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-9-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="교육과-수입의-관계-1" class="slide level2">
<h2>교육과 수입의 관계</h2>
<p><strong><em>능력 편향(Ability Bias)</em></strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>특정 교육 수준과 경력을 가진 남성들의 수입을 비교함.</li>
<li>이를 통제한 후에도 모든 조건이 동일한가?</li>
<li>주어진 <span class="math inline">\(X\)</span> 하에서:
<ul>
<li>근면성이 다른 노동자들을 찾을 수 있는가?</li>
<li>능력이 다른 노동자들을 찾을 수 있는가?</li>
<li>노동자의 가족 배경이 차이가 나는가?</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>물론 그렇다. 따라서 <em>모든 조건이 동일한 것은 아님.</em></li>
<li>이는 문제가 됨. OLS가 일관되려면 다음의 직교성 가정이 필요함: <span class="math display">\[E[e_i | S_i, X_i] \neq 0\]</span></li>
<li>이제 <strong>능력(Ability) <span class="math inline">\(A_i\)</span></strong>를 명시적으로 포함해보자.</li>
</ul>
</div></div>
</section>
<section id="민서의-모델과-관찰되지-않는-능력unobserved-ability" class="slide level2">
<h2>민서의 모델과 관찰되지 않는 능력(Unobserved Ability)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>사실 우리는 <em>두 개</em>의 관찰되지 않는 변수를 가지고 있음: <span class="math inline">\(e\)</span> 와 <span class="math inline">\(A\)</span>.</li>
<li>물론 이를 구별할 수 없음.</li>
<li>따라서 새로운 관찰되지 않는 요인을 정의함: <span class="math display">\[u_i = e_i + A_i\]</span></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-10-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="민서의-모델과-능력-편향의-영향" class="slide level2">
<h2>민서의 모델과 능력 편향의 영향</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>수식으로 표현하면: <span class="math display">\[\log Y_i = \alpha + \rho S_i + \beta_1 X_i + \beta_2 X_i^2 + \underbrace{u_i}_{A_i + e_i}\]</span></li>
<li>때로는 이것이 중요하지 않으며 OLS의 편향이 작을 수 있음.</li>
<li>하지만 경우에 따라서는 상당한 영향을 미쳐 잘못된 결론을 내릴 수 있음. 예제 참고.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/unnamed-chunk-11-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="교육과-수입의-관계-2" class="slide level2 scrollable">
<h2>교육과 수입의 관계</h2>
<p><strong><em>앵그리스트와 크루거(1991): 출생일은 무작위일 것이다!</em></strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>앵그리스트와 크루거(AK91)는 능력 편향을 다루는 영향력 있는 연구임.</li>
<li>연구 아이디어:
<ol type="1">
<li><em>학생의 출생일</em>을 나타내는 도구변수(IV)를 구성함.</li>
<li>특정 컷오프 날짜 이후 태어난 아이들은 학교를 늦게 시작함.</li>
</ol></li>
<li>예시: 2021년 12월 31일까지 6세가 된 아이들은 2021년 9월에 1학년에 입학해야 함.</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>2015년 12월 31일에 태어난 경우, 학교 입학 시 나이는 <strong>5년 9개월</strong>임.</li>
<li>2016년 1월 1일에 태어난 경우, 학교 입학 시 나이는 <strong>6년 9개월</strong>임.</li>
<li>그러나 <strong>법적으로 16세가 되면 학교를 중퇴할 수 있음.</strong></li>
<li>따라서 중퇴하는 사람들 중 일부는 더 많은 교육을 받았음.</li>
<li>AK91은 <strong>출생 분기(quarter of birth) 더미 변수</strong>를 IV로 사용함: 교육 수준에 영향을 주지만 능력(<span class="math inline">\(A\)</span>)과는 관련 없음!</li>
</ul>
</div></div>
</section>
<section id="출생일-설정" class="slide level2">
<h2>출생일 설정</h2>
<p>16세 생일에 학교를 중퇴하면 몇 일 동안 학교에 다니는가?</p>
</section>
<section id="ak91-iv-설정" class="slide level2">
<h2>AK91 IV 설정</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><em>출생 분기(quarter of birth)</em> 더미 변수 <span class="math inline">\(z\)</span>: 교육 수준에 영향을 주지만 능력(<span class="math inline">\(A\)</span>)과는 관련 없음.</li>
<li>특히 <strong>4분기에 태어났는지 여부</strong>를 고려함.</li>
</ul>
</div><div class="column" style="width:50%;">

</div></div>
</section>
<section id="ak91-추정-2단계-최소자승법2sls" class="slide level2 scrollable">
<h2>AK91 추정: 2단계 최소자승법(2SLS)</h2>
<p>AK91은 널리 사용되는 IV 추정 방법인 <strong>2단계 최소자승법(2SLS)</strong>을 소개함.</p>
<ol type="1">
<li><strong>1단계(First Stage):</strong> 도구변수(예: <span class="math inline">\(z\)</span>)를 사용하여 내생 변수 <span class="math inline">\(s\)</span>를 설명하는 모델을 추정함.</li>
<li><strong>2단계(Second Stage):</strong> 1단계 모델을 이용하여 예측된 <span class="math inline">\(s\)</span> 값을 사용하여 <span class="math inline">\(y\)</span>를 추정함. 이를 통해 능력(<span class="math inline">\(A\)</span>)이 <span class="math inline">\(s\)</span>와 <span class="math inline">\(y\)</span> 간의 상관관계에 미치는 영향을 제거함.</li>
</ol>
<p><span class="math display">\[
\text{1단계: } s_i = \alpha_0 + \alpha_1 z_i + \eta_i
\]</span> <span class="math display">\[
\text{2단계: } y_i = \beta_0 + \beta_1 \hat{s}_i + u_i
\]</span></p>
<p><strong><em>조건:</em></strong></p>
<ol type="1">
<li>IV의 <strong>유의성(Relevance):</strong> <span class="math inline">\(\alpha_1 \neq 0\)</span></li>
<li><strong>독립성(Independence):</strong> IV 할당이 무작위와 유사함: <span class="math inline">\(E[\eta | z] = 0\)</span></li>
<li><strong>배제성(Exogeneity):</strong> IV가 결과 변수 <span class="math inline">\(y\)</span>에 미치는 영향이 <strong>오직</strong> <span class="math inline">\(s\)</span>를 통해서만 나타나야 함: <span class="math inline">\(E[u | z] = 0\)</span></li>
</ol>
</section></section>
<section>
<section id="lets-do-angrist-and-krueger-1991" class="title-slide slide level1 center">
<h1>Let’s do Angrist and Krueger (1991)!</h1>

</section>
<section id="출생-분기와-임금-데이터" class="slide level2">
<h2>출생 분기와 임금 데이터</h2>
<p><strong><em>데이터를 불러오고 요약 정보 확인</em></strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_al43wzba569zdm5t0gzv(i, j, css_id) {
          var table = document.getElementById("tinytable_al43wzba569zdm5t0gzv");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_al43wzba569zdm5t0gzv');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_al43wzba569zdm5t0gzv(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_al43wzba569zdm5t0gzv");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 5, j: 0 }, { i: 5, j: 2 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 5, j: 3 }, { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 4, j: 2 }, { i: 4, j: 4 }, { i: 5, j: 4 }, { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 3, j: 3 }, { i: 4, j: 3 }, { i: 4, j: 5 }, { i: 5, j: 5 }, { i: 1, j: 2 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 3, j: 4 }, { i: 3, j: 6 }, { i: 4, j: 6 }, { i: 5, j: 6 }, { i: 1, j: 3 }, { i: 2, j: 3 }, { i: 2, j: 5 }, { i: 3, j: 5 }, { i: 3, j: 7 }, { i: 4, j: 7 }, { i: 5, j: 7 }, { i: 1, j: 4 }, { i: 2, j: 4 }, { i: 2, j: 6 }, { i: 2, j: 8 }, { i: 3, j: 8 }, { i: 4, j: 8 }, { i: 5, j: 8 }, { i: 1, j: 5 }, { i: 1, j: 7 }, { i: 2, j: 7 }, { i: 1, j: 6 }, { i: 1, j: 8 },  ], css_id: 'tinytable_css_zgnbj5bavpyz1k35frua',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 2 }, { i: 0, j: 4 }, { i: 0, j: 6 }, { i: 0, j: 8 }, { i: 0, j: 5 }, { i: 0, j: 7 }, { i: 0, j: 1 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_lrldnxe8qbzildmr2dow',}, 
          { positions: [ { i: 6, j: 5 }, { i: 6, j: 7 }, { i: 6, j: 1 }, { i: 6, j: 3 }, { i: 6, j: 0 }, { i: 6, j: 2 }, { i: 6, j: 4 }, { i: 6, j: 6 }, { i: 6, j: 8 },  ], css_id: 'tinytable_css_i64tu62408bhrobpouq3',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_al43wzba569zdm5t0gzv(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_zgnbj5bavpyz1k35frua, .table th.tinytable_css_zgnbj5bavpyz1k35frua { text-align: left; }
      .table td.tinytable_css_lrldnxe8qbzildmr2dow, .table th.tinytable_css_lrldnxe8qbzildmr2dow { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_i64tu62408bhrobpouq3, .table th.tinytable_css_i64tu62408bhrobpouq3 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_al43wzba569zdm5t0gzv" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Unique</th>
                <th scope="col">Missing Pct.</th>
                <th scope="col">Mean</th>
                <th scope="col">SD</th>
                <th scope="col">Min</th>
                <th scope="col">Median</th>
                <th scope="col">Max</th>
                <th scope="col">Histogram</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>lnw</td>
                  <td>26732</td>
                  <td>0</td>
                  <td>5.9</td>
                  <td>0.7</td>
                  <td>-2.3</td>
                  <td>6.0</td>
                  <td>10.5</td>
                  <td><img src="./tinytable_assets/idblpul7h5oe93gzgcs8m1.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>s</td>
                  <td>21</td>
                  <td>0</td>
                  <td>12.8</td>
                  <td>3.3</td>
                  <td>0.0</td>
                  <td>12.0</td>
                  <td>20.0</td>
                  <td><img src="./tinytable_assets/id6o41rkicw2zqowl5k6cf.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>yob</td>
                  <td>10</td>
                  <td>0</td>
                  <td>1934.6</td>
                  <td>2.9</td>
                  <td>1930.0</td>
                  <td>1935.0</td>
                  <td>1939.0</td>
                  <td><img src="./tinytable_assets/id7sk52dx1ht846lk7h0md.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>qob</td>
                  <td>4</td>
                  <td>0</td>
                  <td>2.5</td>
                  <td>1.1</td>
                  <td>1.0</td>
                  <td>3.0</td>
                  <td>4.0</td>
                  <td><img src="./tinytable_assets/id0vjz1nps42ef2hgr10ah.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>sob</td>
                  <td>51</td>
                  <td>0</td>
                  <td>30.7</td>
                  <td>14.2</td>
                  <td>1.0</td>
                  <td>34.0</td>
                  <td>56.0</td>
                  <td><img src="./tinytable_assets/idkmtxvyoiygvzm8ya4tle.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>age</td>
                  <td>40</td>
                  <td>0</td>
                  <td>45.0</td>
                  <td>2.9</td>
                  <td>40.2</td>
                  <td>45.0</td>
                  <td>50.0</td>
                  <td><img src="./tinytable_assets/id8wfxtljivraaqrhfcrr9.png" style="height: 1em;"></td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="ak91-데이터-변환" class="slide level2">
<h2>AK91 데이터 변환</h2>
<ul>
<li><code>q4</code> 더미 변수 생성 (<code>4분기에 태어났다면 TRUE</code>)</li>
<li>출생 연도(<code>yob</code>) 및 출생 분기(<code>qob</code>)를 범주형 변수로 변환</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>ak91 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(ak91,</span>
<span id="cb3-2"><a href=""></a>               <span class="at">qob_fct =</span> <span class="fu">factor</span>(qob),</span>
<span id="cb3-3"><a href=""></a>               <span class="at">q4 =</span> <span class="fu">as.integer</span>(qob <span class="sc">==</span> <span class="st">"4"</span>),</span>
<span id="cb3-4"><a href=""></a>               <span class="at">yob_fct =</span> <span class="fu">factor</span>(yob))</span>
<span id="cb3-5"><a href=""></a></span>
<span id="cb3-6"><a href=""></a><span class="co"># 연도 및 분기별 평균 임금 및 교육 수준 계산</span></span>
<span id="cb3-7"><a href=""></a>ak91_age <span class="ot">&lt;-</span> ak91 <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href=""></a>  <span class="fu">group_by</span>(qob, yob) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href=""></a>  <span class="fu">summarise</span>(<span class="at">lnw =</span> <span class="fu">mean</span>(lnw), <span class="at">s =</span> <span class="fu">mean</span>(s)) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">q4 =</span> (qob <span class="sc">==</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ak91-그림-1-1단계-회귀-분석" class="slide level2">
<h2>AK91 그림 1: 1단계 회귀 분석</h2>
<p>출생 분기에 따른 교육 수준 변화를 시각화함</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">ggplot</span>(ak91_age, <span class="fu">aes</span>(<span class="at">x =</span> yob <span class="sc">+</span> (qob <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> s )) <span class="sc">+</span></span>
<span id="cb4-2"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb4-3"><a href=""></a>  <span class="fu">geom_label</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> qob, <span class="at">color =</span> q4)) <span class="sc">+</span></span>
<span id="cb4-4"><a href=""></a>  <span class="fu">guides</span>(<span class="at">label =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href=""></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Year of birth"</span>, <span class="at">breaks =</span> <span class="dv">1930</span><span class="sc">:</span><span class="dv">1940</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href=""></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Years of Education"</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">12.2</span>, <span class="fl">13.2</span>, <span class="at">by =</span> <span class="fl">0.2</span>),</span>
<span id="cb4-7"><a href=""></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">12.2</span>, <span class="fl">13.2</span>)) <span class="sc">+</span></span>
<span id="cb4-8"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ak91-그림-1-1단계-회귀-분석-1" class="slide level2 scrollable">
<h2>AK91 그림 1: 1단계 회귀 분석</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>숫자는 출생 분기별 평균 교육 연수를 나타냄.</li>
<li>4분기 출생자는 대부분 더 많은 교육을 받았음.</li>
<li>전반적으로 교육 수준은 증가하는 경향이 있음.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/ak91-dummy-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="ak91-그림-2-도구변수iv가-결과-변수에-미치는-영향" class="slide level2">
<h2>AK91 그림 2: 도구변수(IV)가 결과 변수에 미치는 영향</h2>
<p>출생 분기별 임금 변화를 살펴보자.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">ggplot</span>(ak91_age, <span class="fu">aes</span>(<span class="at">x =</span> yob <span class="sc">+</span> (qob <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">4</span>, <span class="at">y =</span> lnw)) <span class="sc">+</span></span>
<span id="cb5-2"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href=""></a>  <span class="fu">geom_label</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> qob, <span class="at">color =</span> q4)) <span class="sc">+</span></span>
<span id="cb5-4"><a href=""></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Year of birth"</span>, <span class="at">breaks =</span> <span class="dv">1930</span><span class="sc">:</span><span class="dv">1940</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href=""></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Log weekly wages"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href=""></a>  <span class="fu">guides</span>(<span class="at">label =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb5-7"><a href=""></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ak91-그림-2-도구변수iv가-결과-변수에-미치는-영향-1" class="slide level2 scrollable">
<h2>AK91 그림 2: 도구변수(IV)가 결과 변수에 미치는 영향</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>4분기 출생자가 전반적으로 더 높은 임금을 받음.</li>
<li>전체적으로 시간이 지나면서 주간 임금이 다소 감소하는 경향이 있음.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chapter_iv_files/figure-revealjs/ak91-wage-1.svg" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="r에서-iv-추정-실행하기" class="slide level2">
<h2>R에서 IV 추정 실행하기</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>여러 가지 옵션이 있음 (<code>R</code>의 특징! 😉)</li>
<li><code>estimatr</code> 패키지의 <a href="https://declaredesign.org/r/estimatr/reference/iv_robust.html"><code>iv_robust</code></a> 함수를 사용할 것임.</li>
<li><strong><em>Robust</em></strong>? 이 함수는 이분산성(heteroskedasticity)을 고려하여 표준 오차를 계산함. <a href="https://declaredesign.org/r/estimatr/articles/mathematical-notes.html">자세한 설명</a>.</li>
<li><code>predict</code>를 사용하여 <span class="math inline">\(̂{s}\)</span> 값을 얻는 것에 주목해야 함.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" data-code-line-numbers="|11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">library</span>(estimatr)</span>
<span id="cb6-2"><a href=""></a><span class="co"># 모델 리스트 생성</span></span>
<span id="cb6-3"><a href=""></a>mod <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb6-4"><a href=""></a></span>
<span id="cb6-5"><a href=""></a><span class="co"># 표준 (편향된) OLS</span></span>
<span id="cb6-6"><a href=""></a>mod<span class="sc">$</span>ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnw <span class="sc">~</span> s, <span class="at">data =</span> ak91)</span>
<span id="cb6-7"><a href=""></a></span>
<span id="cb6-8"><a href=""></a><span class="co"># IV: 출생 분기가 4분기인가?</span></span>
<span id="cb6-9"><a href=""></a><span class="co"># 2단계 방식으로 IV 수행</span></span>
<span id="cb6-10"><a href=""></a>mod[[<span class="st">"1. stage"</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(s <span class="sc">~</span> q4, <span class="at">data =</span> ak91)</span>
<span id="cb6-11"><a href=""></a>ak91<span class="sc">$</span>shat         <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod[[<span class="st">"1. stage"</span>]])  </span>
<span id="cb6-12"><a href=""></a>mod[[<span class="st">"2. stage"</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(lnw <span class="sc">~</span> shat, <span class="at">data =</span> ak91)</span>
<span id="cb6-13"><a href=""></a></span>
<span id="cb6-14"><a href=""></a><span class="co"># 2SLS 실행</span></span>
<span id="cb6-15"><a href=""></a><span class="co"># IV를 한 번에 수행</span></span>
<span id="cb6-16"><a href=""></a><span class="co"># 공식: y ~ x | z</span></span>
<span id="cb6-17"><a href=""></a>mod<span class="sc">$</span><span class="st">`</span><span class="at">2SLS</span><span class="st">`</span>  <span class="ot">&lt;-</span> <span class="fu">iv_robust</span>(lnw <span class="sc">~</span> s <span class="sc">|</span> q4,</span>
<span id="cb6-18"><a href=""></a>                         <span class="at">data =</span> ak91,</span>
<span id="cb6-19"><a href=""></a>                         <span class="at">diagnostics =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="ak91-결과-테이블" class="slide level2 scrollable">
<h2>AK91 결과 테이블</h2>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:ms1">
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"> </th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">ols</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">1. stage</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">2. stage</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">2SLS</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(Intercept)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">4.995***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">12.747***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">4.955***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">4.955***</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.004)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.007)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.381)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.358)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">s</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.071***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.074**</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.000)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.028)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">q4</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.092***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.013)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">shat</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.074*</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">(0.030)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">R2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.117</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.117</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">RMSE</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.64</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">3.28</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.68</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">0.64</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">1. Stage F:</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">48.9904279659094</td></tr>
<tr>
<td colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 1pt 0pt;    padding: 3.5pt 6pt 3.5pt 6pt; font-weight: normal;">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr>
</tbody></table>

</div>
</div>
</div><div class="column" style="width:35%;">
<ol type="1">
<li>OLS는 측정 오류로 인해 편향될 가능성이 있음.</li>
<li>1단계: IV <code>q4</code>는 통계적으로 유의하나 효과는 작음 (4분기에 태어난 경우 교육 연수 0.092 증가). <span class="math inline">\(R^2\)</span>는 0%지만, F-통계량은 큼.</li>
<li>2단계의 추정치는 <code>2SLS</code>와 동일하지만 표준 오차가 다름 (2단계 결과의 표준 오차는 잘못됨).</li>
</ol>
</div></div>
</section>
<section id="f-통계량" class="slide level2">
<h2>F-통계량</h2>
<ul>
<li><p>제한된 모델과 제한되지 않은 모델을 비교하는 데 유용함.</p></li>
<li><p>여기서는 도구 변수가 <em>공동으로</em> 유의미한지 확인하는 것이 핵심.</p></li>
<li><p>IV가 거의 예측력을 가지지 못하면, F-통계량이 낮아지고 귀무가설을 기각할 수 없음. 😞</p></li>
</ul>
</section>
<section id="추가-제어-변수" class="slide level2">
<h2>추가 제어 변수</h2>
<ul>
<li><p>교육 수준에서 명확한 시간적 경향이 관찰됨.</p></li>
<li><p>임금도 경기 변동의 영향을 받을 가능성이 있음.</p></li>
<li><p>연도 효과를 통제해야 함.</p></li>
<li><p>여러 개의 IV를 사용할 수도 있음.</p></li>
</ul>
</section>
<section id="추가-제어-변수-반영한-추정" class="slide level2">
<h2>추가 제어 변수 반영한 추정</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># we keep adding to our `mod` list:</span></span>
<span id="cb7-2"><a href=""></a>mod<span class="sc">$</span>ols_yr  <span class="ot">&lt;-</span> <span class="fu">update</span>(mod<span class="sc">$</span>ols, . <span class="sc">~</span> . <span class="sc">+</span> yob_fct)  <span class="co">#  previous OLS model</span></span>
<span id="cb7-3"><a href=""></a><span class="co"># add exogenous vars on both sides of the `|` !</span></span>
<span id="cb7-4"><a href=""></a>mod[[<span class="st">"2SLS_yr"</span>]] <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">iv_robust</span>(lnw <span class="sc">~</span> s  <span class="sc">+</span> yob_fct <span class="sc">|</span> q4 <span class="sc">+</span> yob_fct, <span class="at">data =</span> ak91, <span class="at">diagnostics =</span> <span class="cn">TRUE</span> )  </span>
<span id="cb7-5"><a href=""></a><span class="co"># use all quarters as IVs</span></span>
<span id="cb7-6"><a href=""></a>mod[[<span class="st">"2SLS_all"</span>]] <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">iv_robust</span>(lnw <span class="sc">~</span> s  <span class="sc">+</span> yob_fct <span class="sc">|</span> qob_fct <span class="sc">+</span> yob_fct, <span class="at">data =</span> ak91, <span class="at">diagnostics =</span> <span class="cn">TRUE</span>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;"> </th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">ols</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">1. stage</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">2. stage</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">2SLS</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(Intercept)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">4.995***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">12.747***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">4.955***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">4.955***</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.004)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.007)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.381)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.358)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">s</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.071***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.074**</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.000)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.028)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">q4</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.092***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.013)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">shat</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.074*</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.030)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">R2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.117</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.117</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">RMSE</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.64</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">3.28</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.68</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.64</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">1. Stage F:</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">48.9904279659094</td></tr>
<tr>
<td colspan="5" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr>
</tbody></table>

</div>
</div>
</section>
<section id="추가-제어-변수-반영한-결과" class="slide level2">
<h2>추가 제어 변수 반영한 결과</h2>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;"> </th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">ols</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">2SLS</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">ols_yr</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">2SLS_yr</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: bold;">2SLS_all</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(Intercept)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">5.00***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">4.96***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">5.02***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">4.97***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">4.59***</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.00)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.36)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.01)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.35)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.25)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">s</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.07***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.07**</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.07***</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.08**</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.11***</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.00)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.03)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.00)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.03)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">(0.02)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">R2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.117</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.117</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.118</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.117</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0.4pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.091</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">RMSE</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.64</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.64</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.64</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.64</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">0.65</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">Instruments</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">none</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">Q4</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">none</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">Q4</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">All Quarters</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">Year of birth</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">no</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">no</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">yes</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">yes</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">yes</td></tr>
<tr>
<td colspan="6" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 1pt 0pt;    padding: 4pt 6pt 4pt 6pt; font-weight: normal;">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr>
</tbody></table>

</div>
</div>
</div><div class="column" style="width:35%;">
<p><strong>연도 통제 추가</strong>… - OLS 추정치는 거의 변화 없음 - 2SLS 추정치는 소폭 증가</p>
<p><strong>모든 분기를 IV로 사용</strong>… - 2SLS 추정치의 정밀성이 크게 향상됨 - 추정된 계수는 이제 10.5%!</p>
</div></div>
</section>
<section id="ak91-출생-분기를-이용한-도구-변수-qob-iv" class="slide level2 scrollable">
<h2>AK91: 출생 분기를 이용한 도구 변수 (QOB IV)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>일관된 추정치를 얻으려면 다음 조건이 충족되어야 함:
<ol type="1">
<li>IV가 내생적 변수의 예측력이 높아야 함.</li>
<li>IV가 무작위적으로 할당되었거나 누락된 변수와 독립적이어야 함.</li>
<li>IV가 교육을 통해서만 결과 변수에 영향을 미쳐야 함.</li>
</ol></li>
<li>출생 분기(QOB)는 이러한 조건을 충족하는가?</li>
</ul>
</div><div class="column" style="width:50%;">
<ol type="1">
<li><strong>관련성</strong>: 1단계 그림과 높은 F-통계량은 강한 관련성을 보여줌 ✅</li>
<li><strong>독립성</strong>: 출생 분기는 <em>모성 특성</em>과 무관한가? 출생일은 완전히 무작위적이지 않음. 특정 사회경제적 배경에서는 특정 계절에 출산하는 경향이 있음. 그러나 최상위 모성 교육 수준은 2분기에 출산하는 경향이 있으며, 4분기가 아님 ✅</li>
<li><strong>배제 가능성</strong>: 4분기에 태어난 아이들이 초기 학습에서 불리한 환경을 겪고, 장기적으로 부정적인 영향을 받을 가능성은? 그렇다면 <span class="math inline">\(E[u|z] \neq 0\)</span>가 성립함. 하지만 실제로는 4분기 출생자들이 더 높은 교육과 임금을 얻음 ✅</li>
</ol>
</div></div>
</section></section>
<section>
<section id="identification-and-inference" class="title-slide slide level1 center">
<h1>Identification and Inference</h1>

</section>
<section id="iv-식별-identification" class="slide level2 scrollable">
<h2>IV 식별 (Identification)</h2>
<p>선형 모형으로 돌아가 보자:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x + u
\]</span></p>
<p>여기서 <span class="math inline">\(Cov(x,u) \neq 0\)</span> 일 경우, <span class="math inline">\(x\)</span>는 <em>내생적</em> 변수이다.</p>
<p><strong><em>IV의 조건</em></strong></p>
<ol type="1">
<li><strong>1단계 조건(관련성)</strong>: <span class="math inline">\(Cov(z,x) \neq 0\)</span></li>
<li><strong>IV 외생성 조건</strong>: <span class="math inline">\(Cov(z,u) = 0\)</span>, 즉 IV는 결과 방정식에서 외생적이어야 한다.</li>
</ol>
</section>
<section id="유효한-모델a-vs-유효하지-않은-모델b" class="slide level2">
<h2>유효한 모델(A) vs 유효하지 않은 모델(B)</h2>

<img data-src="chapter_iv_files/figure-revealjs/IV-dag2-1.svg" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="iv-식별-조건" class="slide level2 scrollable">
<h2>IV 식별 조건</h2>
<div class="columns">
<div class="column" style="width:50%;">
<blockquote>
<p><strong><em>IV의 조건</em></strong></p>
<ol type="1">
<li><strong>1단계 조건(관련성)</strong>: <span class="math inline">\(Cov(z,x) \neq 0\)</span></li>
<li><strong>IV 외생성 조건</strong>: <span class="math inline">\(Cov(z,u) = 0\)</span></li>
</ol>
</blockquote>
</div><div class="column" style="width:50%;">
<ul>
<li>이러한 조건이 어떻게 <span class="math inline">\(\beta_1\)</span>을 식별하는가?</li>
<li>(이론적으로 <span class="math inline">\(\beta_1\)</span>을 특정할 수 있는 방법은?)</li>
</ul>
</div></div>
</section>
<section id="iv-식별" class="slide level2">
<h2>IV 식별</h2>
<p><span class="math display">\[\begin{align}
Cov(z,y) &amp;= Cov(z, \beta_0 + \beta_1 x + u) \\
         &amp;= \beta_1 Cov(z,x) + Cov(z,u)
\end{align}\]</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>조건 2 (<strong>IV 외생성</strong>)에 따라 <span class="math inline">\(Cov(z,u) = 0\)</span>이면:</li>
</ul>
<p><span class="math display">\[
Cov(z,y) = \beta_1 Cov(z,x)
\]</span></p>
</div><div class="column" style="width:50%;">
<ul>
<li>조건 1 (<strong>관련성</strong>)이 성립하면 <span class="math inline">\(Cov(z,x)\neq0\)</span> 이므로 다음과 같이 나눌 수 있다:</li>
</ul>
<p><span class="math display">\[
\beta_1 = \frac{Cov(z,y)}{Cov(z,x)}.
\]</span></p>
<ul>
<li>따라서 <span class="math inline">\(\beta_1\)</span>은 <em>식별 가능</em>하며, 표본 공식을 이용해 추정할 수 있다.</li>
</ul>
</div></div>
</section>
<section id="iv-추정량" class="slide level2">
<h2>IV 추정량</h2>
<p>표본 공식을 적용하면 다음과 같다:</p>
<p><span class="math display">\[\hat{\beta}_1 = \frac{\sum_{i=1}^n (z_i - \bar{z})(y_i - \bar{y})}{\sum_{i=1}^n (z_i - \bar{z})(x_i - \bar{x})}\]</span></p>
<ul>
<li>절편 추정치는 <span class="math inline">\(\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}\)</span></li>
<li>만약 조건 1, 2가 충족된다면, <strong>IV 추정량은 일치 추정량이 된다</strong>:</li>
</ul>
<p><span class="math display">\[
\text{plim}(\hat{\beta}_1) = \beta_1
\]</span></p>
<p>이 경우, <strong>일관성을 가진 추정량(consistent estimator)</strong>이라고 한다.</p>
</section>
<section id="iv-추정량의-분산" class="slide level2">
<h2>IV 추정량의 분산</h2>
<p><span class="math inline">\(E(u^2|z) = \sigma^2\)</span> 가정 하에:</p>
<p><span class="math display">\[Var(\hat{\beta}_{1,IV}) = \frac{\sigma^2}{n \sigma_x^2 \rho_{x,z}^2}\]</span></p>
<ul>
<li><span class="math inline">\(\sigma_x^2\)</span>: <span class="math inline">\(x\)</span>의 분산</li>
<li><span class="math inline">\(\sigma^2\)</span>: <span class="math inline">\(u\)</span>의 분산</li>
<li><span class="math inline">\(\rho_{x,z}\)</span>: <span class="math inline">\(x\)</span>와 <span class="math inline">\(z\)</span>의 상관계수</li>
</ul>
<p>두 가지 사실을 쉽게 관찰 할 수 있다.</p>
<ul>
<li><span class="math inline">\(\rho_{x,z}\)</span>가 없으면 OLS 분산과 동일</li>
<li>n이 증가하면 분산이 감소</li>
</ul>
</section>
<section id="iv의-분산이-ols보다-항상-큼" class="slide level2">
<h2>IV의 분산이 OLS보다 항상 큼</h2>
<p><span class="math inline">\(\rho_{x,z}\)</span>를 <span class="math inline">\(R_{x,z}^2\)</span>로 바꾸면:</p>
<p><span class="math display">\[Var(\hat{\beta}_{1,IV}) = \frac{\sigma^2}{n \sigma_x^2 R_{x,z}^2}\]</span></p>
<ul>
<li><span class="math inline">\(R_{x,z}^2 &lt; 1\)</span> 이므로, 일반적으로 <span class="math inline">\(Var(\hat{\beta}_{1,IV}) &gt; Var(\hat{\beta}_{1,OLS})\)</span>임.</li>
<li><span class="math inline">\(R_{x,z}^2 = 1\)</span>이면 OLS와 동일해짐. 즉, <span class="math inline">\(z = x\)</span>이면 IV는 불필요함.</li>
</ul>
<p>따라서 외생변수 x가 있으면 굳이 z를 통해 IV 추정을 할 필요가 없다.</p>
</section>
<section id="교육이-여성-임금에-미치는-영향" class="slide level2">
<h2>교육이 여성 임금에 미치는 영향</h2>
<p><span class="math display">\[
\log wage = \beta_0 + \beta_1 educ + u
\]</span></p>
<p>OLS와 IV(부친 학력 사용) 비교:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">data</span>(mroz, <span class="at">package =</span> <span class="st">"wooldridge"</span>)</span>
<span id="cb8-2"><a href=""></a>mods <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb8-3"><a href=""></a>mods<span class="sc">$</span>OLS <span class="ot">&lt;-</span> <span class="fu">lm</span>(lwage <span class="sc">~</span> educ, <span class="at">data =</span> mroz)</span>
<span id="cb8-4"><a href=""></a>mods[[<span class="st">'First Stage'</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(educ <span class="sc">~</span> fatheduc, <span class="at">data =</span> <span class="fu">subset</span>(mroz, inlf <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb8-5"><a href=""></a>mods<span class="sc">$</span>IV  <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">iv_robust</span>(lwage <span class="sc">~</span> educ <span class="sc">|</span> fatheduc, <span class="at">data =</span> mroz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> </th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">OLS</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">First Stage</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">IV</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.185</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">10.237</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.441</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.185)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.276)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.467)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">educ</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.109</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.059</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.014)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.037)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">fatheduc</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.269</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.029)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Num.Obs.</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">428</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">428</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">428</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.118</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.173</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.093</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2 Adj.</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.116</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.171</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.091</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">888.5</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1846.0</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">900.2</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">BIC</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">900.7</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1858.2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">912.4</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Log.Lik.</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-441.260</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-920.025</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">F</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">56.929</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">88.841</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">RMSE</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.68</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.08</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.69</td></tr>
</tbody></table>

</div>
</div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="iv-standard-errors" class="title-slide slide level1 center">
<h1>IV Standard Errors</h1>

<img data-src="chapter_iv_files/figure-revealjs/se-plot-1.svg" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="약한-도구-변수-weak-iv-문제" class="slide level2">
<h2>약한 도구 변수 (Weak IV) 문제</h2>
<p>IV 추정치는 consistent하다</p>
<p>약한 IV의 경우 일치성이 보장되지 않음:</p>
<p><span class="math display">\[
\text{plim}(\hat{\beta}_{1,IV}) = \beta_1 + \frac{Cor(z,u)}{Cor(z,x)} \cdot \frac{\sigma_u}{\sigma_x}
\]</span></p>
<ul>
<li>약한 IV는 <span class="math inline">\(Cor(z,x)\)</span> 값이 작은 경우를 의미함.</li>
<li><span class="math inline">\(Cor(z,x)\)</span>가 작으면 일치성이 깨질 가능성이 높음.</li>
<li>n이 크더라도 실제 모집단의 <span class="math inline">\(\beta_1\)</span>으로 수렵하지 않을 수 있음.</li>
</ul>
</section>
<section id="약한-도구-변수-weak-iv" class="slide level2">
<h2>약한 도구 변수 (Weak IV)</h2>
<ul>
<li>임산부가 하루에 피운 담배 갑 수(<em>packs</em>)가 아기의 출생 체중(<em>bwght</em>)에 미치는 영향을 살펴보자:</li>
</ul>
<p><span class="math display">\[
\log(bwght) = \beta_0 + \beta_1 packs + u
\]</span></p>
<ul>
<li><p>우리는 흡연 행동이 건강 관련 변수들과 상관관계를 가질 수 있으며, 이러한 변수들이 <span class="math inline">\(u\)</span>에 포함되어 출생 체중에 영향을 미칠 가능성이 있다고 우려한다. 따라서 적절한 도구 변수를 찾아야 한다.</p></li>
<li><p>담배 가격(<em>cigprice</em>)을 IV로 사용한다고 가정하자. 이는 담배 가격이 <span class="math inline">\(u\)</span>에 포함된 요인들과 무상관하다는 가정하에 가능하다. 먼저 <em>cigprice</em>가 <em>packs</em>에 미치는 영향을 1단계 회귀분석을 통해 확인한 후, 2단계 최소자승법(2SLS) 추정 결과를 살펴보자.</p></li>
</ul>
</section>
<section id="약한-도구-변수-weak-iv-1" class="slide level2">
<h2>약한 도구 변수 (Weak IV)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">data</span>(bwght, <span class="at">package =</span> <span class="st">"wooldridge"</span>)</span>
<span id="cb9-2"><a href=""></a>mods <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-3"><a href=""></a>mods[[<span class="st">"First Stage"</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(packs <span class="sc">~</span> cigprice, <span class="at">data =</span> bwght)</span>
<span id="cb9-4"><a href=""></a>mods[[<span class="st">"IV"</span>]] <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">iv_robust</span>(<span class="fu">log</span>(bwght) <span class="sc">~</span>  packs <span class="sc">|</span> cigprice, <span class="at">data =</span> bwght, <span class="at">diagnostics =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: bold;"> </th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: bold;">First Stage</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 1pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: bold;">IV</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">(Intercept)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">0.067</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">4.448</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">(0.103)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">(0.940)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">cigprice</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">(0.001)</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">packs</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">2.989</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">(8.996)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">R2</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">0.000</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">-23.230</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">1. Stage F:</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 1pt 0pt;    padding: 5pt 6pt 5pt 6pt; font-weight: normal;">0.120905223674891</td></tr>
</tbody></table>

</div>
</div>
</section>
<section id="약한-도구-변수-weak-iv-2" class="slide level2">
<h2>약한 도구 변수 (Weak IV)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>첫 번째 열: 매우 약한 첫 번째 단계. <em>cigprice</em>가 <em>packs</em>에 미치는 영향이 거의 없다!</p></li>
<li><p><span class="math inline">\(R^2\)</span> 값이 0에 가까움.</p></li>
<li><p>그렇다면 이 IV를 그대로 사용하면 어떻게 될까?</p></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><p>두 번째 열: <em>packs</em>가 출생 체중에 매우 크고, 심지어 <strong>양의</strong> 영향을 미치는 것으로 나타남. 🤔</p></li>
<li><p>하지만 표준 오차가 매우 큼.</p></li>
<li><p><span class="math inline">\(R^2\)</span> 값이 -23?!</p></li>
<li><p>첫 번째 단계의 F-통계량: 0.121. 이는 p-값이 0.728 임을 의미하며, <strong>귀무가설(H0): 첫 번째 단계의 효과 없음</strong>을 전혀 기각할 수 없음.</p></li>
<li><p>결론: <strong>잘못된 접근 방식</strong> ❌</p></li>
</ul>
</div></div>
</section>
<section id="인과-관계를-찾아가는-길" class="slide level2">
<h2>🔍 인과 관계를 찾아가는 길</h2>
<p>✅ 데이터를 어떻게 다룰까?: 읽기(Read), 정리(Tidy), 시각화(Visualize)…</p>
<p>✅ 변수간 관계를 어떻게 요약할까? 단순 / 다중 선형 회귀…비선형회귀, 교차변수…</p>
<p>✅ 인과 관계(Causality)란 무엇인가?</p>
<p>✅ 전체 모집단을 관측하지 못하면 어떻게 할까? Sampling!</p>
<p>✅ 우리의 연구 결과가 단순한 무작위(Randomness) 때문일 수도 있을까? 신뢰구간과 가설검정. 통계적 추론</p>
<p>🚧 <strong><em>실제로 외생성을 어떻게 찾아낼 수 있을까?</em></strong>: 이중 차분, 회귀 불연속 설계, 도구 변수</p>
</section>
<section class="slide level2">

<p><link href="https://fonts.googleapis.com/css2?family=Pacifico&amp;display=swap" rel="stylesheet"></p>
<div style="display: flex; justify-content: center; align-items: center; height: 70vh;">
<h2 style="color: #ff6666; text-align: center; font-family: 'Pacifico', cursive; font-size: 50px;">
<p>THE END!</p>
</h2>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="chapter_iv_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="chapter_iv_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/reveal-text-resizer/revealjs-text-resizer.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="chapter_iv_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="chapter_iv_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'fast',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealTextResizer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>
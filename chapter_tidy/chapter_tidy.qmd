---
title: "Tidying, Visualising and Summarising Data"
subtitle: "FMB819: Rì„ ì´ìš©í•œ ë°ì´í„°ë¶„ì„"
author: "ê³ ë ¤ëŒ€í•™êµ ê²½ì˜ëŒ€í•™ ì •ì§€ì›…"
format: 
  revealjs:
    theme: simple
    transition: fade
    transition-speed: fast
    scrollable: true
    chalkboard: true
    slide-number: true
revealjs-plugins:
  - revealjs-text-resizer # Thanks to https://github.com/gadenbuie/revealjs-text-resizer#readme
---

```{r setup, include=FALSE,warning=FALSE,message=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  dev = "svg",
  cache = TRUE,
  fig.align = "center"
  #fig.width = 11,
  #fig.height = 5
)
```

## Working With Data

<!-- * Economists work with `data`. -->

<!-- ```{r, echo = F, out.width = "400px"} -->

<!-- knitr::include_graphics("chapter_tidy_files/figure-html/data_science_pipeline.png") -->

<!-- ``` -->

<!-- -- -->

-   [2014ë…„ ë‰´ìš•íƒ€ì„ì¦ˆ ê¸°ì‚¬](https://www.nytimes.com/2014/08/18/technology/for-big-data-scientists-hurdle-to-insights-is-janitor-work.html)ì— ë”°ë¥´ë©´, "ë°ì´í„° ê³¼í•™ìë“¤ì€ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê¸° ì „ì— **50%ì—ì„œ 80%ì˜ ì‹œê°„**ì„ ë°ì´í„° ìˆ˜ì§‘ ë° ì •ë¦¬ì— ì†Œë¹„í•œë‹¤."ë¼ê³  í•¨.

-   ë‹¤ìŒ ë‘ ê°•ì˜ì—ì„œëŠ” **ë°ì´í„° ì •ë¦¬, ì‹œê°í™”, ìš”ì•½**ì˜ ê¸°ë³¸ì„ ë°°ì›€.

# Tidying Data

------------------------------------------------------------------------

## `dplyr` ì†Œê°œ

-   [`dplyr`](https://dplyr.tidyverse.org)ì€ [`tidyverse`](https://www.tidyverse.org) íŒ¨í‚¤ì§€êµ°ì˜ ì¼ë¶€.
-   [`data.table`](https://github.com/Rdatatable/data.table/wiki)ë„ ëŒ€ì•ˆìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë©°, ëŒ€ìš©ëŸ‰ ë°ì´í„°ì— ìµœì í™”ë˜ì–´ ìˆìŒ.
-   ì—¬ê¸°ì„œëŠ” `dplyr`ì„ ë‹¤ë£¸.

------------------------------------------------------------------------

## `dplyr` ê°œìš”

-   Hadley Wickhamì˜ "R for Data Science" [ì˜ë¬¸](https://r4ds.had.co.nz/transform.html) [êµ­ë¬¸](https://bookdown.org/sulgi/r4ds/)
-   [ì¹˜íŠ¸ì‹œíŠ¸](https://github.com/rstudio/cheatsheets/blob/master/data-transformation.pdf)ë„ ë§¤ìš° ìœ ìš©.
-   `dplyr`ì€ ì—¬ëŸ¬ **verbs** ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŒ.
-   `data.frame` ë˜ëŠ” `tibble` í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ë‹¤ë£° ê²ƒì„.

$$\text{verb}(\underbrace{\text{data.frame}}_{\text{1st argument}}, \underbrace{\text{what to do}}_\text{2nd argument})$$

-   ë˜ëŠ” `pipe` ì—°ì‚°ì `%>%` ì´ìš© (`magrittr` íŒ¨í‚¤ì§€):

$$\underbrace{\text{data.frame}}_{\text{1st argument}} \underbrace{\text{ %>% }}_{\text{"pipe" operator}} \text{verb}(\underbrace{\text{what to do}}_\text{2nd argument})$$

------------------------------------------------------------------------

## ì£¼ìš” `dplyr` verbs

1.  `filter()`: íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” í–‰ ì„ íƒ
2.  `arrange()`: í–‰ ì •ë ¬
3.  `select()`: íŠ¹ì • ì—´ ì„ íƒ
4.  `mutate()`: ê¸°ì¡´ ì—´ì„ ì´ìš©í•˜ì—¬ ìƒˆ ë³€ìˆ˜ ìƒì„±
5.  `summarise()`: ìš”ì•½ í†µê³„ ê³„ì‚°
6.  `group_by()`: ê·¸ë£¹ë³„ ì—°ì‚° ìˆ˜í–‰ ê°€ëŠ¥

------------------------------------------------------------------------

## ì˜ˆì œ ë°ì´í„°: 2016ë…„ ë¯¸êµ­ ëŒ€ì„  ì—¬ë¡ ì¡°ì‚¬ (`dslabs` íŒ¨í‚¤ì§€)

-   2016ë…„ ë¯¸êµ­ ëŒ€ì„ ê³¼ ê´€ë ¨ëœ ì—¬ë¡ ì¡°ì‚¬ ë°ì´í„°ë¥¼ í¬í•¨

```{r dslabs, echo = TRUE}
library(dslabs)
library(tidyverse)
data(polls_us_election_2016, package = "dslabs")
polls_us_election_2016 <- as_tibble(polls_us_election_2016) # ë°ì´í„°ë¥¼ 'tibble' í˜•ì‹ìœ¼ë¡œ ë³€í™˜
head(polls_us_election_2016[,1:6]) # ë°ì´í„°ì˜ ì²« 6ê°œì˜ í–‰ê³¼ ì²« 6ê°œì˜ ì—´ì„ ì¶œë ¥
```

------------------------------------------------------------------------

## ì˜ˆì œ ë°ì´í„°: 2016ë…„ ë¯¸êµ­ ëŒ€ì„  ì—¬ë¡ ì¡°ì‚¬ (`dslabs` íŒ¨í‚¤ì§€)

-   ì´ ë°ì´í„°ì…‹ì— ì–´ë–¤ ë³€ìˆ˜ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

```{r, echo=TRUE}
str(polls_us_election_2016) # ë°ì´í„°ì˜ êµ¬ì¡°ë¥¼ ìš”ì•½í•˜ì—¬ ì¶œë ¥
```

------------------------------------------------------------------------

## `dplyr`: `filter()`

```{r, echo=TRUE}
# í‘œë³¸ í¬ê¸°(samplesize)ê°€ 2000ë³´ë‹¤ í° í–‰ë§Œ ì„ íƒ, ì¸¨ë ¥
polls_us_election_2016 %>%
  filter(samplesize > 2000)
```

------------------------------------------------------------------------

## `dplyr`: `filter()`

ê¸°ë³¸ì ì¸ ë¹„êµ ì—°ì‚°ì:

-   `>`: í¬ë‹¤ (greater than)

-   `<`: ì‘ë‹¤ (smaller than)

-   `>=`: í¬ê±°ë‚˜ ê°™ë‹¤ (greater than or equal to)

-   `<=`: ì‘ê±°ë‚˜ ê°™ë‹¤ (smaller than or equal to)

-   `!=`: ê°™ì§€ ì•Šë‹¤ (not equal to)

-   `==`: ê°™ë‹¤ (equal to)

ë…¼ë¦¬ ì—°ì‚°ì:

1.  `x & y`: `x` **ê·¸ë¦¬ê³ ** `y` (ë‘˜ ë‹¤ ì°¸ì¼ ë•Œë§Œ ì°¸)

2.  `x | y`: `x` **ë˜ëŠ”** `y` (ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ì°¸ì´ë©´ ì°¸)

3.  `!y`: **yê°€ ì•„ë‹ ë•Œ** (ë…¼ë¦¬ ë°˜ì „)

------------------------------------------------------------------------

## `dplyr`: `filter()`

-   `%in%` ì—°ì‚°ìì˜ ì´ìš©

-   `x %in% y`ëŠ” `x`ê°€ `y`ì˜ ìš”ì†Œì¸ì§€ í™•ì¸

-   `!(x %in% y)`ë¥¼ ì‚¬ìš©í•˜ë©´ ë°˜ëŒ€ì˜ ë…¼ë¦¬ ì ìš©

```{r, echo=TRUE}
# 3ì´ 1ë¶€í„° 3ê¹Œì§€ì˜ ìˆ«ì ì¤‘ í•˜ë‚˜ì¸ì§€ í™•ì¸ (TRUE)
3 %in% 1:3  

# ë²¡í„°í™”ëœ ì—°ì‚°: 2ì™€ 5ê°€ 2ë¶€í„° 10 ì‚¬ì´ì˜ ìˆ«ì ì¤‘ í•˜ë‚˜ì¸ì§€ í™•ì¸ (ê°ê° TRUEì™€ TRUE)
c(2,5) %in% 2:10  

# ë¬¸ìì—´ ë¹„êµ: "S" ë˜ëŠ” "Po"ê°€ ë²¡í„° `c("Sciences","Po")`ì˜ ìš”ì†Œì¸ì§€ í™•ì¸
c("K","Uni") %in% c("Korea","University")  
```

------------------------------------------------------------------------

## `dplyr`: `filter()`

A ë“±ê¸‰ì„ ë°›ì€ ì—¬ë¡ ì¡°ì‚¬ ì¤‘ í‘œë³¸ í¬ê¸°ê°€ 2,000ëª… ì´ìƒì´ê³ , íŠ¸ëŸ¼í”„ê°€ ìµœì†Œ 45%ì˜ ì§€ì§€ë¥¼ ë°›ì€ ì—¬ë¡ ì¡°ì‚¬ëŠ”?

```{r, echo=TRUE}
# polls_us_election_2016 ë°ì´í„°ì—ì„œ 
# 1. ë“±ê¸‰(grade)ì´ "A"ì´ê³ 
# 2. í‘œë³¸ í¬ê¸°(samplesize)ê°€ 2000ëª…ë³´ë‹¤ í¬ë©°
# 3. íŠ¸ëŸ¼í”„ì˜ ì—¬ë¡ ì¡°ì‚¬ ì§€ì§€ìœ¨(rawpoll_trump)ì´ 45% ì´ìƒì¸ í–‰ì„ í•„í„°ë§í•©ë‹ˆë‹¤.
polls_us_election_2016 %>%
  filter(grade == "A" & samplesize > 2000 & rawpoll_trump > 45) 
```

------------------------------------------------------------------------

## `dplyr`: `mutate()`

1.  ê° ì—¬ë¡ ì¡°ì‚¬ì—ì„œ íŠ¸ëŸ¼í”„ì™€ í´ë¦°í„´ì˜ ì§€ì§€ìœ¨ í•©ê³„
2.  íŠ¸ëŸ¼í”„ì˜ ì›ë˜(raw) ì§€ì§€ìœ¨ê³¼ FiveThirtyEightì˜ ì¡°ì •(adjusted) ì§€ì§€ìœ¨ ê°„ì˜ ì°¨ì´

```{r, echo=TRUE}
#| code-line-numbers: "|5|6|7"
# 1. trump_clinton_tot: íŠ¸ëŸ¼í”„ì™€ í´ë¦°í„´ì˜ ì§€ì§€ìœ¨ í•©ê³„
# 2. trump_raw_adj_diff: íŠ¸ëŸ¼í”„ì˜ ì›ë˜ ì§€ì§€ìœ¨ê³¼ 538 ì¡°ì • ì§€ì§€ìœ¨ ê°„ì˜ ì°¨ì´
# ë§ˆì§€ë§‰ìœ¼ë¡œ names() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì˜ ë³€ìˆ˜ëª…ì„ í™•ì¸.
polls_us_election_2016 %>%
  mutate(trump_clinton_tot = rawpoll_trump + rawpoll_clinton, # íŠ¸ëŸ¼í”„ì™€ í´ë¦°í„´ ì§€ì§€ìœ¨ í•©ê³„
         trump_raw_adj_diff = rawpoll_trump - adjpoll_trump) %>% # ì›ë˜ ì§€ì§€ìœ¨ê³¼ ì¡°ì • ì§€ì§€ìœ¨ ì°¨ì´
  names() # ë³€ìˆ˜ëª… ì¶œë ¥
```

------------------------------------------------------------------------

## `dplyr`: `select()`

-   ë‹¤ìŒ ë³€ìˆ˜ë§Œ ì„ íƒ: `state, startdate, enddate, pollster, rawpoll_clinton, rawpoll_trump`

```{r, echo = TRUE}
# select() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì—´ë§Œ ì„ íƒ.
# 1. state: ì¡°ì‚¬ëœ ì£¼(State)
# 2. startdate: ì—¬ë¡ ì¡°ì‚¬ê°€ ì‹œì‘ëœ ë‚ ì§œ
# 3. enddate: ì—¬ë¡ ì¡°ì‚¬ê°€ ì¢…ë£Œëœ ë‚ ì§œ
# 4. pollster: ì—¬ë¡ ì¡°ì‚¬ ê¸°ê´€
# 5. rawpoll_clinton: íëŸ¬ë¦¬ í´ë¦°í„´ì˜ ì›ë˜(raw) ì§€ì§€ìœ¨
# 6. rawpoll_trump: ë„ë„ë“œ íŠ¸ëŸ¼í”„ì˜ ì›ë˜(raw) ì§€ì§€ìœ¨

polls_us_election_2016 %>%
  select(state, startdate, enddate, pollster, rawpoll_clinton, rawpoll_trump) %>% 
  names() # ë°ì´í„° í”„ë ˆì„ì˜ ë³€ìˆ˜ëª…ì„ ì¶œë ¥í•˜ì—¬ ì˜¬ë°”ë¥´ê²Œ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸
```

------------------------------------------------------------------------

## `dplyr`: `summarise()`

-   íŠ¸ëŸ¼í”„ì˜ ìµœëŒ€ ì§€ì§€ìœ¨ì€ ì–¼ë§ˆì¸ê°€?

```{r, echo = TRUE}
# summarise() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¸ëŸ¼í”„ì˜ ìµœëŒ€(raw) ì§€ì§€ìœ¨ì„ ê³„ì‚°
# max() í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ì—´ì—ì„œ ê°€ì¥ í° ê°’ì„ ë°˜í™˜

polls_us_election_2016 %>%
  summarise(max_trump = max(rawpoll_trump)) # íŠ¸ëŸ¼í”„ì˜ ìµœëŒ€ ì§€ì§€ìœ¨ ê³„ì‚°
```

------------------------------------------------------------------------

## `dplyr`: `group_by()`

-   ì—¬ë¡ ì¡°ì‚¬ ë“±ê¸‰(grade)ë³„ í´ë¦°í„´ì˜ í‰ê·  ì§€ì§€ìœ¨ì€ ì–¼ë§ˆì¸ê°€?

```{r, echo = TRUE}
# group_by()ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ë¡ ì¡°ì‚¬ ë“±ê¸‰(grade)ë³„ë¡œ ê·¸ë£¹ì„ ë‚˜ëˆ”.
# summarise()ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ê·¸ë£¹ì—ì„œ rawpoll_clinton(í´ë¦°í„´ì˜ ì›ë˜ ì§€ì§€ìœ¨)ì˜ í‰ê·  ê³„ì‚°

polls_us_election_2016 %>%
  group_by(grade) %>% # ì—¬ë¡ ì¡°ì‚¬ ë“±ê¸‰ë³„ ê·¸ë£¹í™”
  summarise(mean_vote_clinton = mean(rawpoll_clinton, na.rm = TRUE)) # ê° ê·¸ë£¹ì—ì„œ í´ë¦°í„´ì˜ í‰ê·  ì§€ì§€ìœ¨ ê³„ì‚°
```

------------------------------------------------------------------------

## ëª…ë ¹ì–´ ì—°ê²°í•˜ê¸°

::::: columns
::: {.column width="40%"}
```{r, echo=TRUE, eval = FALSE}
polls_us_election_2016
```
:::

::: {.column width="60%"}
```{r, echo = FALSE}
polls_us_election_2016
```
:::
:::::

------------------------------------------------------------------------

## ëª…ë ¹ì–´ ì—°ê²°í•˜ê¸°

::::: columns
::: {.column width="40%"}
```{r, echo=TRUE, eval = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) 
```
:::

::: {.column width="60%"}
```{r, echo = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) 
```
:::
:::::

------------------------------------------------------------------------

## ëª…ë ¹ì–´ ì—°ê²°í•˜ê¸°

::::: columns
::: {.column width="40%"}
```{r, echo=TRUE, eval = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) %>%
    filter(trump_clinton_diff>5 &
           state == "Iowa" &
           is.na(rawpoll_johnson))
```
:::

::: {.column width="60%"}
```{r, echo = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) %>%
    filter(trump_clinton_diff>5 &
           state == "Iowa" &
           is.na(rawpoll_johnson))
```
:::
:::::

## ëª…ë ¹ì–´ ì—°ê²°í•˜ê¸°

::::: columns
::: {.column width="40%"}
```{r, echo=TRUE, eval = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) %>%
    filter(trump_clinton_diff>5 &
           state == "Iowa" &
           is.na(rawpoll_johnson)) %>%
    select(pollster) # pollster(ì—¬ë¡ ì¡°ì‚¬ ê¸°ê´€) ì—´ë§Œ ì„ íƒ
```
:::

::: {.column width="60%"}
```{r, echo = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) %>%
    filter(trump_clinton_diff>5 &
           state == "Iowa" &
           is.na(rawpoll_johnson)) %>%
    select(pollster)
```
:::
:::::

---


## ëª…ë ¹ì–´ ì—°ê²°í•˜ê¸°

::::: columns
::: {.column width="40%"}
```{r, echo=TRUE, eval = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) %>%
    filter(trump_clinton_diff>5 &
           state == "Iowa" &
           is.na(rawpoll_johnson)) %>%
    pull(pollster) # pollster(ì—¬ë¡ ì¡°ì‚¬ ê¸°ê´€) ì—´ì˜ ê°’ì„ ì¶”ì¶œí•˜ì—¬ ë²¡í„°ë¡œ ë°˜í™˜
```
:::

::: {.column width="60%"}
```{r, echo = FALSE}
polls_us_election_2016 %>%
    mutate(trump_clinton_diff = 
             rawpoll_trump - 
             rawpoll_clinton) %>%
    filter(trump_clinton_diff>5 &
           state == "Iowa" &
           is.na(rawpoll_johnson)) %>%
    pull(pollster) 
```
:::
:::::

------------------------------------------------------------------------

## ë‹¤ë¥¸ `R` ëª…ë ¹ì–´ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥

::::: columns
::: {.column width="50%"}
```{r, echo=TRUE}
polls_us_election_2016$samplesize %>% 
    mean(na.rm = TRUE) #samplesize ê°’ë“¤ì˜ í‰ê· ì„ ê³„ì‚°í•˜ë˜, NA(ê²°ì¸¡ê°’)ëŠ” ì œê±° 
```
:::

::: {.column width="50%"}
```{r, echo=TRUE}
polls_us_election_2016 %>% 
    count() # ì´ í–‰ ê°œìˆ˜ë¥¼ ê³„ì‚° (ì¦‰, ìˆ˜í–‰ëœ ì—¬ë¡ ì¡°ì‚¬ì˜ ì´ ê°œìˆ˜) 
```
:::
:::::

-   `%>%` ì—°ì‚°ìëŠ” magrittr íŒ¨í‚¤ì§€ì—ì„œ ì œê³µ. 
-   R v4.1.0ë¶€í„° ê¸°ë³¸ ì œê³µ(native) íŒŒì´í”„ ì—°ì‚°ìì¸ `|>` ì¶”ê°€

```{r, echo=TRUE}
polls_us_election_2016$samplesize |> mean(na.rm = TRUE)
```



------------------------------------------------------------------------

## ê²°ì¸¡ê°’(`NA`) ì²˜ë¦¬

::::: columns
::: {.column width="50%"}
-   ê°’ì´ *ëˆ„ë½(missing)* ë˜ì—ˆì„ ê²½ìš° `NA`ë¡œ í‘œì‹œë¨.

```{r, echo=TRUE}
x <- NA  # xì— ê²°ì¸¡ê°’(NA) í• ë‹¹
```

-   `NA`ê°€ í¬í•¨ëœ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ë©´, ê²°ê³¼ë„ `NA`ê°€ ë¨.

```{r, echo=TRUE}
NA > 5    # NAëŠ” ìˆ«ìê°€ ì•„ë‹ˆë¯€ë¡œ ë¹„êµ ë¶ˆê°€ëŠ¥ -> NA ë°˜í™˜
NA + 10   # NAì™€ ì—°ì‚°í•˜ë©´ ê²°ê³¼ë„ NA
```

-   `is.na(x)` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ê°’ì´ `NA`ì¸ì§€ í™•ì¸ ê°€ëŠ¥.

```{r, echo=TRUE}
is.na(x)  # xê°€ NAì¸ì§€ í™•ì¸ -> TRUE ë°˜í™˜
```
:::

::: {.column width="50%"}
-   NA ê°’ì€ ì„œë¡œ ë¹„êµí•  ìˆ˜ ì—†ìŒ.

```{r, echo=TRUE}
NA == NA  # NAë¼ë¦¬ ë¹„êµí•˜ë©´ ê²°ê³¼ë„ NA
```

-   ì˜ˆì œ

```{r, echo=TRUE}
# xëŠ” Maryì˜ ë‚˜ì´, ì •í™•í•œ ë‚˜ì´ë¥¼ ëª¨ë¦„.
x <- NA

# yëŠ” Johnì˜ ë‚˜ì´, ì •í™•í•œ ë‚˜ì´ë¥¼ ëª¨ë¦„.
y <- NA

# Johnê³¼ Maryì˜ ë‚˜ì´ê°€ ê°™ì€ê°€?
x == y
```

-   `NA == NA`ëŠ” `TRUE`ê°€ ì•„ë‹ˆë¼ `NA`ë¥¼ ë°˜í™˜í•˜ëŠ”ë°, ì´ëŠ” ë‘ ê°’ì´ ê°™ì€ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì„.
:::
:::::

------------------------------------------------------------------------

## Task 1 {background-color="#ffebf0"}

```{r, echo = T, eval = F}
library(dslabs)
data(polls_us_election_2016)
```

1.  grade ê°’ì´ ê²°ì¸¡ì¹˜(NA)ì¸ ì—¬ë¡ ì¡°ì‚¬ëŠ”?

2.  ë‹¤ìŒ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” ì—¬ë¡ ì¡°ì‚¬ëŠ”? (i) American Strategies, GfK Group, Merrill Pollì—ì„œ ì¡°ì‚¬í•œ ê²½ìš°, (ii) í‘œë³¸ í¬ê¸°ê°€ 1,000ëª… ì´ìƒì¸ ê²½ìš°, (iii) 2016ë…„ 10ì›” 20ì¼ì— ì‹œì‘ëœ ê²½ìš°. **íŒíŠ¸**: (i) ì¡°ê±´ì—ì„œëŠ” %in% ì—°ì‚°ìê°€ ìœ ìš©, ë²¡í„°ëŠ” `c()`í•¨ìˆ˜ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŒ. (iii)ì—ì„œëŠ” ë‚ ì§œ ë³€ìˆ˜ì˜ í˜•ì‹ì„ í™•ì¸ "yyyy-mm-dd"

3.  ë‹¤ìŒ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” ì—¬ë¡ ì¡°ì‚¬ëŠ”? (i) Johnson í›„ë³´ì˜ ì—¬ë¡ ì¡°ì‚¬ ë°ì´í„°ê°€ ëˆ„ë½ë˜ì§€ ì•Šì€ ê²½ìš°, (ii) íŠ¸ëŸ¼í”„ì™€ í´ë¦°í„´ì˜ ì›ë³¸ ì—¬ë¡ ì¡°ì‚¬ ì§€ì§€ìœ¨ í•©ì´ 95%ë¥¼ ì´ˆê³¼í•˜ëŠ” ê²½ìš°, (iii) ì˜¤í•˜ì´ì˜¤(OH) ì£¼ì—ì„œ ì‹¤ì‹œëœ ê²½ìš° **íŒíŠ¸**: íŠ¸ëŸ¼í”„ì™€ í´ë¦°í„´ì˜ ì§€ì§€ìœ¨ í•©ê³„ë¥¼ ê³„ì‚°í•˜ëŠ” ìƒˆë¡œìš´ ë³€ìˆ˜ë¥¼ ìƒì„±í•œ í›„ `filter()` ë¥¼ ì ìš©

4.  í‘œë³¸ í¬ê¸°ê°€ 2,000ëª… ì´ìƒì¸ ì—¬ë¡ ì¡°ì‚¬ì—ì„œ íŠ¸ëŸ¼í”„ì˜ í‰ê·  ì§€ì§€ìœ¨ì´ ê°€ì¥ ë†’ì€ ì£¼ëŠ”? **íŒíŠ¸**: `filter(), group_by(), summarise(), arrange()` ì‚¬ìš©. ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•˜ë ¤ë©´ `arrange()` í•¨ìˆ˜ ì‚¬ìš©.
  



# Visualising Data

## ê¸°ë³¸ `R` ê·¸ë˜í”„ì™€ `ggplot2`

-   `ggplot2` (ì´ íŒ¨í‚¤ì§€ëŠ” `tidyverse`ì˜ ì¼ë¶€) ê¸°ë³¸ `R`ì˜ ê·¸ë˜í”„ ê¸°ëŠ¥ì€ ë³´ë‹¤ í›¨ì”¬ ê°•ë ¥í•¨

-   ì˜ˆì œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ `gapminder` ë°ì´í„°ì…‹ ì‚¬ìš©.

------------------------------------------------------------------------

## `gapminder` ê°œìš”

-   ë¨¼ì € `gapminder` ë°ì´í„°ë¥¼ ë¡œë“œ:

```{r, echo = TRUE}
library(dslabs) # dslabs íŒ¨í‚¤ì§€ ë¡œë“œ
data(gapminder, package = "dslabs") # gapminder ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°
```

-   ë°ì´í„°ì˜ ì²˜ìŒ 3ê°œ í–‰ê³¼ ë§ˆì§€ë§‰ 2ê°œ í–‰ì„ í™•ì¸.

```{r, echo = TRUE}
head(gapminder, n = 3) # ë°ì´í„°ì˜ ì²˜ìŒ 3í–‰ ì¶œë ¥
tail(gapminder, n = 2) # ë°ì´í„°ì˜ ë§ˆì§€ë§‰ 2í–‰ ì¶œë ¥
```

------------------------------------------------------------------------

## Task 2 {background-color="#ffebf0"}

1.  ëŒ€ë¥™/ì—°ë„ë³„ í‰ê·  ì¸êµ¬(ë³€ìˆ˜ëª…: mean_pop)ë¥¼ ê³„ì‚°í•˜ê³ , ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ ê°ì²´ gapminder_meanì— ì €ì¥í•˜ì‹œì˜¤. **íŒíŠ¸**: ê° ì—°ë„ë³„ ëŒ€ë¥™ë‹¹ í•˜ë‚˜ì˜ ê´€ì¸¡ì¹˜(í–‰)ë§Œ ìˆì–´ì•¼ í•¨. `group_by` ë° `summarise` ì‚¬ìš©

```{r, echo=F}
gapminder_mean <- gapminder %>%
  group_by(continent, year) %>%
  summarise(mean_pop = mean(population))
```

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

``` r
data %>%
  ggplot()
```

or

``` r
ggplot(data)
```
:::

::: {.column width="60%"}
-   Tidy Data

    -   ê° ë³€ìˆ˜ëŠ” ***ì—´(column)***ì„ í˜•ì„±

    -   ê° ê´€ì¸¡ì¹˜ëŠ” ***í–‰(row)***ì„ í˜•ì„±


-   ì‹œê°í™”ë¥¼ ì‹œì‘í•  ë•Œ ê³ ë ¤ ì‚¬í•­

    -   ì‹œê°í™”ì—ì„œ ì–´ë–¤ ì •ë³´ë¥¼ ì‚¬ìš©í•  ê²ƒì¸ê°€?

    -   í•´ë‹¹ ë°ì´í„°ê°€ í•˜ë‚˜ì˜ ì—´ ë˜ëŠ” í–‰ì— í¬í•¨ë˜ì–´ ìˆëŠ”ê°€?
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

``` r
+ aes()
```
:::

::: {.column width="60%"}
ë°ì´í„°ë¥¼ ì‹œê°ì  ìš”ì†Œ ë˜ëŠ” ë§¤ê°œë³€ìˆ˜ì— ë§¤í•‘

-   year (ì—°ë„)

-   population (ì¸êµ¬)

-   country (êµ­ê°€)
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

``` r
+ aes()
```
:::

::: {.column width="60%"}
ë°ì´í„°ë¥¼ ì‹œê°ì  ìš”ì†Œ ë˜ëŠ” ë§¤ê°œë³€ìˆ˜ì— ë§¤í•‘

-   year (ì—°ë„) â†’ **x**

-   population (ì¸êµ¬) â†’ **y**

-   country (êµ­ê°€) â†’ *shape*, *color*, etc.
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

``` r
+ aes()
```
:::

::: {.column width="60%"}
``` r
aes(
  x = year,
  y = population,
  color = country
)
```
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

``` r
+ geom_*()
```
:::

::: {.column width="60%"}
Geometric objects:

```{r geom_demo, echo=FALSE, fig.width=6, fig.height=3.5,  out.width="650px"}
minimal_theme <- theme_bw() +
  theme(
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank(),
    panel.border = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(hjust = 0.5),
    text = element_text(family = "Fira Mono"),
    plot.background = element_rect(fill = "white", color = NA),
    panel.background = element_rect(fill = "white", color = NA)
  )
set.seed(4242)
df_geom <- data_frame(y = rnorm(10), x = 1:10)
g_geom <- list()
g_geom$point <- ggplot(df_geom, aes(x, y)) + geom_point() + ggtitle("geom_point()")
g_geom$line <- ggplot(df_geom, aes(x, y)) + geom_line() + ggtitle("geom_line()")
g_geom$bar <- ggplot(df_geom, aes(x, y)) + geom_col() + ggtitle("geom_col()")
g_geom$boxplot <- ggplot(df_geom, aes(y = y)) + geom_boxplot() + ggtitle("geom_boxplot()")
g_geom$histogram <- ggplot(df_geom, aes(y)) + geom_histogram(binwidth = 1) + ggtitle("geom_histogram()")
g_geom$density <- ggplot(df_geom, aes(y)) + geom_density(fill = "grey40", alpha = 0.25) + ggtitle("geom_density()") + xlim(-4, 4)
g_geom <- map(g_geom, ~ . + minimal_theme)
cowplot::plot_grid(plotlist = g_geom)
```
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

``` r
+ geom_*()
```
:::

::: {.column width="60%"}
[ë§í¬: ë§ì´ ì‚¬ìš©ë˜ëŠ” geoms](https://eric.netlify.com/2017/08/10/most-popular-ggplot2-geoms/)

|    ìœ í˜•     |            í•¨ìˆ˜            |
|:-----------:|:--------------------------:|
|   í¬ì¸íŠ¸    |       `geom_point()`       |
|     ì„       |       `geom_line()`        |
| ë§‰ëŒ€ ê·¸ë˜í”„ | `geom_bar()`, `geom_col()` |
| íˆìŠ¤í† ê·¸ë¨  |     `geom_histogram()`     |
|   íšŒê·€ì„     |      `geom_smooth()`       |
|  ë°•ìŠ¤í”Œë¡¯   |      `geom_boxplot()`      |
|   í…ìŠ¤íŠ¸    |       `geom_text()`        |
| ìˆ˜ì§/ìˆ˜í‰ì„  |     `geom_{vh}line()`      |
|  ê°œìˆ˜ ì„¸ê¸°  |       `geom_count()`       |
| ë°€ë„ ê·¸ë˜í”„ |      `geom_density()`      |
:::
:::::


------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

``` r
+ geom_*()
```
:::

::: {.column width="60%"}
`RStudio`ì—ì„œ `geom_`ì„ ì…ë ¥í•˜ë©´ ìë™ ì™„ì„± ê¸°ëŠ¥ì„ í†µí•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì˜µì…˜ í™•ì¸ ê°€ëŠ¥

<img src="chapter_tidy_files/figure-html/geom.gif" width="300px" style="float: center;"/>
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r first-plot0a, echo=TRUE, eval=FALSE}
gapminder_mean
```
:::

::: {.column width="60%"}
```{r first-plot0a-out, ref.label='first-plot0a', echo=FALSE}
```
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r first-plot1a, echo=TRUE, eval=FALSE}
gapminder_mean %>%
  ggplot() 
```
:::

::: {.column width="60%"}
```{r first-plot1a-out, ref.label='first-plot1a', echo=FALSE, fig.height = 3.5, out.width="100%"}
```
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r first-plot1b, echo=TRUE, eval=FALSE}
gapminder_mean %>%
  ggplot() +
  aes(x = year, #<<
      y = mean_pop) #<<
```
:::

::: {.column width="60%"}
```{r first-plot1b-out, ref.label='first-plot1b', echo=FALSE, fig.height = 3.5, out.width="100%"}
```
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r first-plot1c, echo=TRUE, eval=FALSE}
gapminder_mean %>%
  ggplot() +
  aes(x = year,
      y = mean_pop) +
  geom_point() #<<
```
:::

::: {.column width="60%"}
```{r first-plot1c-out, ref.label='first-plot1c', echo=FALSE, fig.height = 3.5, out.width="100%"}
```
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r first-plot1,  echo=TRUE, eval=FALSE}
gapminder_mean %>%
  ggplot() +
  aes(x = year,
      y = mean_pop,
      color = continent) + #<<
  geom_point()
```
:::

::: {.column width="60%"}
```{r first-plot1-out, ref.label='first-plot1', echo=FALSE, fig.height = 3.5, out.width="100%"}
```
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r first-plot2-fake, echo=TRUE, eval=FALSE}
gapminder_mean %>%
  ggplot() +
  aes(x = year,
      y = mean_pop,
      color = continent) +
  geom_point() +
  geom_line() #<<
```
:::

::: {.column width="60%"}
```{r first-plot2-fake-out, ref.label='first-plot2-fake', fig.height = 3.5, echo=FALSE, out.width="100%"}
```
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r first-plot2-line, echo=TRUE, eval=FALSE}
gapminder_mean %>%
  ggplot() +
  aes(x = year,
      y = mean_pop,
      color = continent) +
  # geom_point() + #<<
  geom_line()
```
:::

::: {.column width="60%"}
```{r first-plot2-line-out, ref.label='first-plot2-line', fig.height = 3.5, echo=FALSE, out.width="100%"}
```
:::
:::::

------------------------------------------------------------------------

## (Y)Our first plot!

::::: columns
::: {.column width="40%"}
```{r save-plot, echo=TRUE, eval=FALSE}
g = gapminder_mean %>% #<<
  ggplot() +
  aes(x = year,
      y = mean_pop,
      color = continent) +
  # geom_point() + 
  geom_line()
g   #<<
# graphs can be saved as
# objects!
```
:::

::: {.column width="60%"}
```{r save-plot-out, ref.label='save-plot', fig.height = 3.5, echo=FALSE, out.width="100%"}
```
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

``` r
+ facet_wrap() 
+ facet_grid()
```
:::

::: {.column width="60%"}
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

``` r
+ facet_wrap() 
+ facet_grid()
```
:::

::: {.column width="60%"}
```{r geom_facet_setup, include=FALSE}
g <- ggplot(gapminder_mean) +
  aes(x = year,
      y = mean_pop,
      color = continent) +
  geom_point() +
  geom_line()
```

```{r geom_facet, echo=TRUE, out.width="90%", fig.height = 3.5, fig.width=6}
g + facet_wrap(~ continent)
```
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

``` r
+ facet_wrap() 
+ facet_grid()
```
:::

::: {.column width="60%"}
```{r geom_grid, echo=TRUE, out.width="90%", fig.height = 3.5, fig.width=6}
g + facet_grid(~ continent)
```
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

Labels

``` r
+ labs()
```
:::

::: {.column width="60%"}
```{r labs-ex, echo=TRUE, out.width="90%", fig.height = 3.5, fig.width=6}
g + labs(x = "Year", y = "Average Population", color = "Continent")
```
:::
:::::

------------------------------------------------------------------------

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

Labels

Scales

``` r
+ scale_*_*()
```
:::

::: {.column width="60%"}
`scale` + `_` + `<aes>` + `_` + `<type>` + `()`

ì–´ë–¤ ë§¤ê°œë³€ìˆ˜ë¥¼ ì¡°ì •í•˜ê³  ì‹¶ì€ê°€? â†’ `<aes>`

ê·¸ ë§¤ê°œë³€ìˆ˜ì˜ ìœ í˜•ì€ ë¬´ì—‡ì¸ê°€? â†’ `<type>`
      
- ì´ì‚°í˜•(xì¶•) ì¡°ì • <br> `scale_x_discrete()`
- ì—°ì†í˜• ë³€ìˆ˜ì—ì„œ í¬ì¸íŠ¸ í¬ê¸° ì¡°ì • <br>`scale_size_continuous()`
- yì¶•ì„ ë¡œê·¸ ìŠ¤ì¼€ì¼ë¡œ ë³€í™˜ <br>`scale_y_log10()`
- ìƒ‰ìƒ ì„¸íŒ… ë³€í™˜ <br>`scale_fill_discrete()`<br>`scale_color_manual()`

:::
:::::

---


## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

Labels

Scales

``` r
+ scale_*_*()
```
:::

::: {.column width="60%"}
```{r scale_ex1, out.width="90%", fig.height = 3.5, fig.width=6, echo=TRUE}
g + scale_color_viridis_d()
```
:::
:::::

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

Labels

Scales

``` r
+ scale_*_*()
```
:::

::: {.column width="60%"}
```{r scale_ex2, out.width="90%", fig.height = 3.5, fig.width=6, echo=TRUE}
g + scale_y_log10()
```
:::
:::::

## gg = Grammar of Graphics

::::: columns
::: {.column width="40%"}
Data

Aesthetics

Geoms

Facet

Labels

Scales

``` r
+ scale_*_*()
```
:::

::: {.column width="60%"}
```{r scale_ex4, out.width="90%", fig.height = 3.5, fig.width=6, echo=TRUE}
g + scale_x_continuous(breaks = seq(1950, 2020, 10))
```
:::
:::::

------------------------------------------------------------------------

## `ggplot` ì‹¬í™” íƒêµ¬

-   `ggplot2`ëŠ” ì‚¬ìš©ìê°€ ì •ì˜í•  ìˆ˜ ìˆëŠ” ë¬´ìˆ˜í•œ ì˜µì…˜ì„ ì œê³µ.

-   [ggplot ì›¹ì‚¬ì´íŠ¸](https://ggplot2.tidyverse.org)ì— ìˆëŠ” ì¹˜íŠ¸ì‹œíŠ¸ë¥¼ ì°¸ê³ .

-   [Garrick Aden-Buie](https://www.garrickadenbuie.com/)ì˜ [Gentle Guide to the Grammar of Graphics with `ggplot2`](https://pkg.garrickadenbuie.com/gentle-ggplot2/#1)

------------------------------------------------------------------------

## Plotì˜ ì¢…ë¥˜

***Histograms:*** íŠ¹ì • êµ¬ê°„(bin) ë‚´ì˜ ê´€ì¸¡ê°’ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„

***Boxplots:*** ë³€ìˆ˜ì˜ ë¶„í¬ë¥¼ ë‚˜íƒ€ëƒ„

```{r, echo = F, out.width = "850px"}
knitr::include_graphics("chapter_tidy_files/figure-html/boxplot_explanation.png")
```

------------------------------------------------------------------------

## Plotì˜ ì¢…ë¥˜

***Histograms:*** íŠ¹ì • êµ¬ê°„(bin) ë‚´ì˜ ê´€ì¸¡ê°’ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„

***Boxplots:*** ë³€ìˆ˜ì˜ ë¶„í¬ë¥¼ ë‚˜íƒ€ëƒ„

***Scatter plots:*** ë‘ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ë³´ì—¬ì¤Œ

------------------------------------------------------------------------

## Task 3 {background-color="#ffebf0"}

`gapminder` ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒì˜ ê·¸ë˜í”„ë¥¼ `ggplot2`ë¡œ ìƒì„±í•˜ì‹œì˜¤

1.  2015ë…„ ê¸°ëŒ€ìˆ˜ëª…(Life Expectancy)ì˜ íˆìŠ¤í† ê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤. **íŒíŠ¸**: íˆìŠ¤í† ê·¸ë¨ì„ ë§Œë“¤ ë•Œ aes()ì— y ê°’ì„ ì§€ì •í•´ì•¼ í• ê¹Œ? `geom_*` ë‚´ì—ì„œ ë‹¤ìŒ ì˜µì…˜ì„ ì„¤ì •í•˜ì‹œì˜¤: `binwidth` = 5, `boundary` = 45, `colour` = "white", `fill` = "#d90502". xì¶•ì€ "ê¸°ëŒ€ ìˆ˜ëª…", yì¶•ì€ "ë¹ˆë„"ë¡œ ë ˆì´ë¸” í•˜ì‹œì˜¤. ì´ëŸ¬í•œ ì˜µì…˜ì´ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ ì„¤ëª…í•˜ì‹œì˜¤.

    *Optional:* ìƒì„±í•œ íˆìŠ¤í† ê·¸ë¨ì„ ëŒ€ë¥™(Continent)ë³„ë¡œ ë‚˜ëˆ„ì–´ (`facet_grid()`) ê° ëŒ€ë¥™ì´ ìƒˆë¡œìš´ í–‰(row)ì— í‘œì‹œë˜ë„ë¡ ë§Œë“œì‹œì˜¤. **íŒíŠ¸**: `facet_grid(rows_vars(continent)`

2.  ì—°ë„/ëŒ€ë¥™ë³„ í‰ê·  ê¸°ëŒ€ìˆ˜ëª…ì„ êµ¬í•˜ê³  ëŒ€ë¥™ë³„ë¡œ í‰ê·  ê¸°ëŒ€ìˆ˜ëª…ì— ëŒ€í•œ Boxplot ìœ¼ë¡œ ê·¸ë¦¬ì‹œì˜¤. `geom_*` ì˜µì…˜: `colour` = "black", `fill` = "#d90502". **íŒíŠ¸**: continent ë° year ë‘ ê°œì˜ ë³€ìˆ˜ë¡œ ê·¸ë£¹í™”í•´ì•¼í•¨.

3.  2015ë…„ ì¶œì‚°ìœ¨(Fertility Rate, yì¶•)ê³¼ ì˜ì•„ ì‚¬ë§ë¥ (Infant Mortality, xì¶•) ê°„ì˜ ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì‚°ì ë„ (Scatter Plot)ë¥¼ ì‘ì„±í•˜ì‹œì˜¤. `geom_*` ì˜µì…˜: `size` = 3, `alpha` = 0.5, `colour` = "#d90502". `labs()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë ˆì´ë¸”ì„ ì¶”ê°€ (x = "ì˜ì•„ ì‚¬ë§ë¥ ", y = "ì¶œì‚°ìœ¨")



# Summarising



## Summarising Data

-   ì¼ë°˜ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ê±°ë‚˜ ìš”ì•½ í†µê³„ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë¶„ì„ì„ ì‹œì‘.

-   ì´ì œ **ìš”ì•½ í†µê³„(summary statistics)**ë¥¼ ì‚´í´ë³´ê² ìŒ.

-   íŠ¹íˆ, **ì¤‘ì‹¬ ê²½í–¥(central tendency)**ê³¼ **ì‚°í¬ë„(spread)**ë¥¼ ì¤‘ì ì ìœ¼ë¡œ ë‹¤ë£° ê²ƒì„.

------------------------------------------------------------------------

## Central Tendency

::::: columns
::: {.column width="45%"}
-   í‰ê·  (Mean)

`mean(x)`: `x`ì˜ ëª¨ë“  ê°’ì˜ í‰ê· ì„ ê³„ì‚°. $$\bar{x} = \frac{1}{N}\sum_{i=1}^N x_i$$

```{r, echo=T}
x <- c(1,2,2,2,2,100)  # ë°ì´í„° ìƒ˜í”Œ
mean(x)  # í‰ê·  ê³„ì‚°
mean(x) == sum(x) / length(x)  # í‰ê·  ê³µì‹ í™•ì¸
```
:::

::: {.column width="45%"}
-   ì¤‘ì•™ê°’ (Median)

`median(x)`: `x`ì˜ ê°’ë“¤ ì¤‘ **50%ê°€ í•´ë‹¹ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ê³ , 50%ê°€ í¬ê±°ë‚˜ ê°™ì€ ê°’**ì„ ì°¾ìŒ. $m$ì´ ì¤‘ì•™ê°’ì´ë¼ë©´: $$\Pr(X \leq m) \geq 0.5 \text{ ê·¸ë¦¬ê³  } \Pr(X \geq m) \geq 0.5$$

ì¤‘ì•™ê°’ì€ **ì´ìƒì¹˜(outliers)**ì— ê°•ê±´(robust).

```{r}
median(x, echo=T)  # ì¤‘ì•™ê°’ ê³„ì‚°
```
:::
:::::

------------------------------------------------------------------------

## Spread

::::: columns
::: {.column width="45%"}
ì¤‘ì‹¬(í‰ê· )ì—ì„œ ì–¼ë§ˆë‚˜ í¼ì ¸ ìˆëŠ”ì§€ë¥¼ ì¸¡ì •

ë¶„ì‚°(Variance)ì€ ì´ëŸ¬í•œ ë¶„í¬ì˜ ì²™ë„ ì¤‘ í•˜ë‚˜

$$Var(X) = \frac{1}{N} \sum_{i=1}^N(x_i-\bar{x})^2$$

í‰ê· ì´ 0ì¸ ë‘ ê°œì˜ `ì •ê·œ ë¶„í¬`ë¥¼ ë¹„êµí•´ ë³´ì.
:::

::: {.column width="55%"}
```{r, echo = FALSE, fig.height=4, message = FALSE, warning = FALSE}
library(ggplot2)

ggplot(data = data.frame(x = c(-5, 5)), aes(x)) +
  stat_function(fun = dnorm, n = 101, args = list(mean = 0, sd = 1), aes(color = "1"), size = 2) +
  stat_function(fun = dnorm, n = 101, args = list(mean = 0, sd = 2), aes(color = "4"), size = 2) +
  ylab(NULL) +
  scale_y_continuous(breaks = NULL) +
  scale_color_manual("ë¶„ì‚°:", values = c("#d90502", "#DE9854")) +
  theme_bw() +
  theme(legend.position = c(0.02,0.98),
        legend.justification = c(0,1),
        text = element_text(size=20))
```

ë¶„ì‚° ê³„ì‚°:

```{r, eval = FALSE, echo=TRUE}
var(x)
```
:::
:::::

------------------------------------------------------------------------

## Tabulating Data

-   `table(x)` í•¨ìˆ˜ëŠ” `x` ë‚´ ê° ê³ ìœ  ê°’ì˜ ë°œìƒ íšŸìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” ë° ìœ ìš©.

```{r, echo=TRUE}
table(gapminder$continent)
```

-   ë™ì¼í•œ ì‘ì—…ì„ dplyrì˜ count í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆìŒ.

```{r, echo=TRUE}
gapminder %>% count(continent)
```

------------------------------------------------------------------------

## Tabulating Data

-   Contingency Table ìƒì„±

```{r, echo=TRUE}
gapminder_new <- gapminder %>%
  filter(year == 2015) %>%
  mutate(fertility_above_2 = (fertility > 2)) # dummy variable for fertility rate above replacement rate
```

::::: columns
::: {.column width="45%"}
```{r, echo=TRUE}
table(gapminder_new$fertility_above_2)
```
:::

::: {.column width="55%"}
```{r, echo=TRUE}
table(gapminder_new$fertility_above_2,gapminder_new$continent)
```
:::
:::::

- `prop.table`ì„ ì‚¬ìš©í•˜ì—¬ ë¹„ìœ¨ì„ ê³„ì‚° ê°€ëŠ¥:

```{r, echo=TRUE}
# proportions by row
prop.table(table(gapminder_new$fertility_above_2,gapminder_new$continent), margin = 1)
# proportions by column
prop.table(table(gapminder_new$fertility_above_2,gapminder_new$continent), margin = 2) 
```

-   `NA` ê°’ì„ í¬í•¨í•œ `table` ë˜ëŠ” `crosstable`ì„ ì–»ìœ¼ë ¤ë©´ `useNA = "always"` ë˜ëŠ” `useNA = "ifany"` ì˜µì…˜ì„ ì‚¬ìš©

------------------------------------------------------------------------

## Tabulating Data

-   count í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œ ë°ì´í„° ìš”ì•½

```{r, echo=T}
gapminder_new %>%
  count(continent, fertility_above_2)
```

        
- `count` í•¨ìˆ˜ëŠ” `NA` ê°’ì´ í¬í•¨ëœ ê²½ìš°ì—ë§Œ ì´ë¥¼ í‘œì‹œ.


------------------------------------------------------------------------

## ê³µë¶„ì‚° (Covariance)ê³¼ ìƒê´€ê³„ìˆ˜ (Correlation)

```{r x-y-corr,echo=TRUE,eval=TRUE,fig.align='center',fig.height = 4,fig.width=8}
ggplot(gapminder_new, aes(x=infant_mortality, y=fertility)) +
  geom_point(color="#d90502") +
  labs(
    title = "Relationship between fertility and infant mortality in 2015",
    x = "Infant mortality",
    y = "Fertility rate"
  ) +  theme_minimal()
```

------------------------------------------------------------------------

## Covariance

-   ê³µë¶„ì‚°ì€ ë‘ ë³€ìˆ˜ì˜ ê³µë™ ë³€ë™ì„±(joint variability) ì„ ì¸¡ì •í•˜ëŠ” ì§€í‘œ

    $$Cov(x,y) = \frac{1}{N} \sum_{i=1}^N(x_i-\bar{x})(y_i-\bar{y})$$

```{r, echo=T}
cov(gapminder_new$fertility,gapminder_new$infant_mortality, use = "complete.obs")
```

------------------------------------------------------------------------

## Correlation

-   ìƒê´€ê´€ê³„ëŠ” ë‘ ë³€ìˆ˜ ê°„ì˜ ì„ í˜• ê´€ê³„(linear association) ì˜ ê°•ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ì§€í‘œ $$Cor(x,y) = \frac{Cov(x,y)}{\sqrt{Var(x)}\sqrt{Var(y)}}$$

```{r, echo=T}
cor(gapminder_new$fertility,gapminder_new$infant_mortality, use = "complete.obs")
```

------------------------------------------------------------------------

## Correlation

-   ìƒê´€ê³„ìˆ˜ëŠ” í•­ìƒ -1ê³¼ 1 ì‚¬ì´ì˜ ê°’ì„ ê°€ì§

```{r, echo = F, out.width = "100%"}
knitr::include_graphics("chapter_tidy_files/figure-html/correlation.svg")
```

\[ *Source: [mathisfun](https://www.mathsisfun.com/data/correlation.html)*\]

------------------------------------------------------------------------

## Correlation

<!-- * [App](https://gustavek.shinyapps.io/corr_continuous/) -->

```{r, echo = F}
knitr::include_url("https://gustavek.shinyapps.io/corr_continuous/")
```

------------------------------------------------------------------------

## Task 4 {background-color="#ffebf0"}

1.  2011ë…„ GDPì˜ í‰ê· ì„ ê³„ì‚°í•˜ê³  meanì´ë¼ëŠ” ê°ì²´ì— í• ë‹¹í•˜ì‹œì˜¤. ê²°ì¸¡ê°’ì€ ì œì™¸. **íŒíŠ¸**: `mean` í•¨ìˆ˜ì˜ ë„ì›€ë§ì„ ì½ê³  `NA`ë¥¼ ì œê±°í•˜ëŠ” ë°©ë²•ì„ í™•ì¸

2.  2011ë…„ GDPì˜ ì¤‘ì•™ê°’ì„ ê³„ì‚°í•˜ê³  medianì´ë¼ëŠ” ê°ì²´ì— í• ë‹¹í•˜ì‹œì˜¤. ë§ˆì°¬ê°€ì§€ë¡œ ê²°ì¸¡ê°’ì„ ì œì™¸. ì¤‘ì•™ê°’ì´ í‰ê· ë³´ë‹¤ í°ê°€, ì‘ì€ê°€?

3.  `geom_density`ë¥¼ ì‚¬ìš©í•˜ì—¬ 2011ë…„ GDPì˜ ë°€ë„ ê·¸ë˜í”„(density plot)ë¥¼ ìƒì„±í•˜ì‹œì˜¤. ë°€ë„ ê·¸ë˜í”„ëŠ” ìˆ«ìí˜• ë³€ìˆ˜ì˜ ë¶„í¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë°©ë²•ì„. ë˜í•œ ë‹¤ìŒ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì—¬ í‰ê· ê³¼ ì¤‘ì•™ê°’ì„ ìˆ˜ì§ì„ ìœ¼ë¡œ í‘œì‹œí•˜ì‹œì˜¤.

    ``` r
    geom_vline(xintercept = as.numeric(mean), colour = "red") +
    geom_vline(xintercept = as.numeric(median), colour = "orange")
    ```

4.  2015ë…„ ì¶œì‚°ìœ¨(fertility)ê³¼ ìœ ì•„ ì‚¬ë§ë¥ (infant mortality)ì˜ ìƒê´€ê´€ê³„ë¥¼ ê³„ì‚°í•˜ì‹œì˜¤. NA ê°’ì„ ì œì™¸í•˜ë ¤ë©´ `cor()` í•¨ìˆ˜ì˜ `use` ì¸ìˆ˜ë¥¼ "pairwise.complete.obs"ë¡œ ì„¤ì •. ì´ ìƒê´€ê´€ê³„ ê°’ì´ Task 3ì—ì„œ ìƒì„±í•œ ê·¸ë˜í”„ì™€ ì¼ì¹˜í•˜ëŠ”ê°€?




------------------------------------------------------------------------

## ğŸ” ì¸ê³¼ ê´€ê³„ë¥¼ ì°¾ì•„ê°€ëŠ” ê¸¸

âœ… **ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ë‹¤ë£°ê¹Œ?** : ì½ê¸°(Read), ì •ë¦¬(Tidy), ì‹œê°í™”(Visualize)...

âŒ ë³€ìˆ˜ ê°„ ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ìš”ì•½í• ê¹Œ? ë‹¨ìˆœ ì„ í˜• íšŒê·€(Simple Linear Regression)

âŒ ì¸ê³¼ ê´€ê³„(Causality)ë€ ë¬´ì—‡ì¸ê°€?

âŒ ì „ì²´ ëª¨ì§‘ë‹¨ì„ ê´€ì¸¡í•˜ì§€ ëª»í•˜ë©´ ì–´ë–»ê²Œ í• ê¹Œ?

âŒ ìš°ë¦¬ì˜ ì—°êµ¬ ê²°ê³¼ê°€ ë‹¨ìˆœí•œ ë¬´ì‘ìœ„(Randomness) ë•Œë¬¸ì¼ ìˆ˜ë„ ìˆì„ê¹Œ?

âŒ ì‹¤ì œë¡œ ì™¸ìƒì„±ì„ ì–´ë–»ê²Œ ì°¾ì•„ë‚¼ ìˆ˜ ìˆì„ê¹Œ?

------------------------------------------------------------------------

<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

::: {style="display: flex; justify-content: center; align-items: center; height: 70vh;"}
<h2 style="color: #ff6666; text-align: center; font-family: &#39;Pacifico&#39;, cursive; font-size: 50px;">

THE END!

</h2>
:::

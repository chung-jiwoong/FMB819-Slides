---
title: "FMB819: Rì„ ì´ìš©í•œ ë°ì´í„°ë¶„ì„"
subtitle: "<span style='font-size:1.5em; color:#a01616;'>Regression Discontinuity Design</span>"
# date: "`r Sys.Date()`"
format:
  revealjs:
    slide-number: true
    # smaller: true
    scrollable: true
    chalkboard: true
    transition: fade
    transition-speed: fast
    #incremental: true
    #lib_dir: libs
    css: [default, "../css/kubs.css", "../css/kubs-fonts.css"]
    #nature:
      # beforeInit: ["../js/ru_xaringan.js"]
      #highlightStyle: github
      #highlightLines: true
      #countIncrementalSlides: false
    #  ratio: "16:9"
    # includes:
    #   in_header: "../libs/partials/header.html"
revealjs-plugins:
  - revealjs-text-resizer
---

```{r setup, include=FALSE,warning=FALSE,message=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  dev = "svg",
  cache = TRUE,
  fig.align = "center"
  #fig.width = 11,
  #fig.height = 5
)

# library(emo)
library(tidyverse)
library(ggplot2)
library(kableExtra)
library(zoo)
library(scales)
library(grid)
library(pBrackets)
library(formattable)


library(countdown)

# countdown style
countdown(
  color_border              = "#d90502",
  color_text                = "black",
  color_running_background  = "#d90502",
  color_running_text        = "white",
  color_finished_background = "white",
  color_finished_text       = "#d90502",
  color_finished_border     = "#d90502"
)

  # set seed
set.seed(1234)
```

------------------------------------------------------------------------

## Today's Agenda

***íšŒê·€ ë¶ˆì—°ì† ì„¤ê³„ (Regression Discontinuity Design)***

-   í˜„ì‹¤ì—ì„œëŠ” íŠ¹ì • ê¸°ì¤€ì— ë”°ë¼ ì²˜ì¹˜ê°€ í• ë‹¹ë˜ëŠ” ë¬´ì‘ìœ„ ê·œì¹™ì´ ë§ìŒ.

-   ì´ëŸ¬í•œ **í• ë‹¹ ê·œì¹™**ì— ëŒ€í•œ ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ì¸ê³¼ íš¨ê³¼ë¥¼ ì¶”ì •í•  ìˆ˜ ìˆìŒ.

-   ***í•µì‹¬ ê°€ì •:*** ì²˜ì¹˜ë¥¼ ê²°ì •í•˜ëŠ” ë³€ìˆ˜ëŠ” ê°œì¸ì´ ì¡°ì‘í•  ìˆ˜ ì—†ì–´ì•¼ í•¨.

-   *ì‹¤ì¦ì  ì ìš©:* ì•Œì½”ì˜¬ ì†Œë¹„ê°€ ì‚¬ë§ë¥ ì— ë¯¸ì¹˜ëŠ” íš¨ê³¼ ë¶„ì„.

------------------------------------------------------------------------

## íšŒê·€ ë¶ˆì—°ì† ì„¤ê³„ (Regression Discontinuity Design)

-   ì‘ìš© ì—°êµ¬ì—ì„œ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì—°êµ¬ ì„¤ê³„ë¡œ, ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì¸ê³¼ ì¶”ì •ì¹˜ë¥¼ ì œê³µí•¨.

-   ***ì¶œë°œì :*** ì²˜ì¹˜ëŠ” ë¬´ì‘ìœ„ë¡œ í• ë‹¹ë˜ì§€ ì•ŠìŒ âš ï¸

-   íŠ¹ì • ê·œì¹™ì— ë”°ë¼ ì²˜ì¹˜ê°€ ê²°ì •ë˜ëŠ” ê²½ìš° RDDë¥¼ ì ìš©í•  ìˆ˜ ìˆìŒ.

-   \_\_RDD\_\_ëŠ” ì²˜ì¹˜ í• ë‹¹ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ì¸ê³¼ íš¨ê³¼ë¥¼ ì¶”ì •í•¨!

------------------------------------------------------------------------

## ë¶ˆì—°ì†ì„±ì€ ì–´ë””ì—ë‚˜ ì¡´ì¬í•¨

ì‚¶ì—ëŠ” ì²˜ì¹˜ë¥¼ ê²°ì •í•˜ëŠ” ë§ì€ ì„ì˜ì ì¸ ê·œì¹™ì´ ì¡´ì¬í•¨:

-   ë…¸ìŠ¤ìºë¡¤ë¼ì´ë‚˜ì—ì„œëŠ”, í•´ë‹¹ ì—°ë„ì˜ **10ì›” 16ì¼ê¹Œì§€ 5ì„¸ê°€ ë˜ì–´ì•¼** ìœ ì¹˜ì› ì…í•™ì´ ê°€ëŠ¥í–ˆìŒ [(Cook and Kang, 2016)](https://pubs.aeaweb.org/doi/pdfplus/10.1257/app.20140323).

-   ë¯¸êµ­ì—ì„œëŠ” **ì¶œìƒ ì²´ì¤‘ì´ 1,500g ë¯¸ë§Œì¸ ì‹ ìƒì•„**ê°€ "ë§¤ìš° ì €ì²´ì¤‘(Very Low Birth Weight)"ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ ì¶”ê°€ ì¹˜ë£Œë¥¼ ë°›ìŒ [(Almond et al., 2010)](https://academic.oup.com/qje/article/125/2/591/1882183).

-   ì£¼ìš” ì£¼ë¦½ëŒ€(flagship universities)ëŠ” íŠ¹ì • **SAT ì ìˆ˜ ê¸°ì¤€**ì„ ì‚¬ìš©í•˜ì—¬ í•™ìƒì„ ì„ ë°œí•¨ [(Hoekstra, 2009)](https://cdn.theatlantic.com/static/mt/assets/business/Hoekstra_Flagship.pdf).

-   ì´íƒˆë¦¬ì•„ì—ì„œëŠ” **ë¶ˆë²• ì´ë¯¼ìì˜ ê±°ì£¼ í—ˆê°€ ì¿¼í„°**ê°€ ì„ ì°©ìˆœìœ¼ë¡œ í• ë‹¹ë˜ë©°, ì •ì›ì´ ì°¨ë©´ ë§ˆê°ë¨ [(Pinotti, 2017)](https://pubs.aeaweb.org/doi/pdfplus/10.1257/aer.20150355).

ì´ë²ˆ ë¶„ì„ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¶ˆì—°ì†ì„±ì— ì´ˆì ì„ ë§ì¶œ ê²ƒì„:

-   ë¯¸êµ­ì—ì„œ **ë²•ì  ìŒì£¼ ê°€ëŠ¥ ì—°ë ¹ì€ 21ì„¸**ì„ [(Carpenter and Dobkin, 2009)](http://masteringmetrics.com/wp-content/uploads/2015/01/Carpenter-and-Dobkin-2009.pdf).

------------------------------------------------------------------------

## ì˜ˆì œ: ì•Œì½”ì˜¬ ì†Œë¹„ì™€ ì‚¬ë§ë¥ 

-   ì Šì€ ì„±ì¸ì˜ **ì•Œì½”ì˜¬ ì†Œë¹„ê°€ ì‚¬ë§ë¥ ì— ë¯¸ì¹˜ëŠ” ì¸ê³¼ì  íš¨ê³¼**ë¥¼ í‰ê°€í•˜ê³ ì í•œë‹¤ê³  ê°€ì •í•˜ì.

-   í•˜ì§€ë§Œ ì´ëŠ” ë‹¨ìˆœí•œ ë¬¸ì œê°€ ì•„ë‹˜. ë‹¨ìˆœíˆ **ì•Œì½”ì˜¬ ì†Œë¹„ë¥¼ ì‚¬ë§ ì—°ë ¹ ë° ì‚¬ë§ ì›ì¸ì— ëŒ€í•œ íšŒê·€ ë¶„ì„**ìœ¼ë¡œ ì¶”ì •í•  ìˆ˜ ì—†ëŠ” ì´ìœ ëŠ”?

    -   ì•Œì½”ì˜¬ ì†Œë¹„ ì—¬ë¶€ì— ë”°ë¼ ì„ íƒ í¸í–¥(selection bias)ì´ ì¡´ì¬í•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì‚¬ë§ë¥ ì˜ ê²°ì • ìš”ì¸ì¼ ê°€ëŠ¥ì„±ì´ ìˆìŒ.

-   ë¯¸êµ­ì—ì„œëŠ” **21ì„¸ ë¯¸ë§Œì˜ ì•Œì½”ì˜¬ ì†Œë¹„ê°€ ë²•ì ìœ¼ë¡œ ê¸ˆì§€ë¨**.

-   ì¼ë¶€ì—ì„œëŠ” **ë²•ì  ìŒì£¼ ê°€ëŠ¥ ì—°ë ¹(MLDA, Minimum Legal Drinking Age)**ì„ 18ì„¸ë¡œ ë‚®ì¶”ìëŠ” ë…¼ìŸì´ ì¡´ì¬í•¨ (ë² íŠ¸ë‚¨ ì „ìŸ ì‹œëŒ€ì™€ ìœ ì‚¬í•œ ì¡°ì¹˜).

------------------------------------------------------------------------

## í•µì‹¬ ê°œë… ë° ì§ê´€

> ***ì—°ì† ë³€ìˆ˜ (Running Variable):*** ì²˜ì¹˜ í• ë‹¹ì„ ê²°ì •í•˜ëŠ” ë³€ìˆ˜.

$\rightarrow a = \text{ë‚˜ì´}$

> ***ì ˆë‹¨ê°’ (Cutoff Level):*** ì²˜ì¹˜ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ì¤€ì´ ë˜ëŠ” ë³€ìˆ˜ì˜ ê°’.

$\rightarrow c = 21$ (21ì„¸ ìƒì¼)

***ì¸ê³¼ì  ì§ê´€:***

-   **21ì„¸ ìƒì¼ ì§ì „ê³¼ ì§í›„**ì˜ ê°œì¸ë“¤ì€ ë²•ì  ìŒì£¼ ê°€ëŠ¥ ì—¬ë¶€ ì™¸ì— ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ê°€?

-   ì ˆë‹¨ê°’ ê·¼ì²˜ì—ì„œëŠ” ì²˜ì¹˜ í• ë‹¹ì´ **ë¬´ì‘ìœ„ì™€ ê°™ìŒ**.

-   ğŸ‘‰ ***íšŒê·€ ë¶ˆì—°ì† ì„¤ê³„(RDD)***ëŠ” ì´ëŸ¬í•œ ì²˜ì¹˜ í• ë‹¹ì„ í™œìš©í•˜ì—¬ ì¸ê³¼ íš¨ê³¼ë¥¼ ì¶”ì •í•¨!

------------------------------------------------------------------------

## Carpenterì™€ Dobkinì˜ ë°ì´í„° {#carpenter}

-   ì´ ì—°êµ¬ì—ì„œ ì‚¬ìš©ëœ ë°ì´í„°ë¥¼ ì‚´í´ë³´ì.

::::: columns
::: {.column width="50%"}
```{r, echo = TRUE, eval = TRUE}
# ë°ì´í„° í¬í•¨ëœ íŒ¨í‚¤ì§€ ì„¤ì¹˜
devtools::install_github("jrnold/masteringmetrics",
                         subdir = "masteringmetrics")

# íŒ¨í‚¤ì§€ ë¡œë“œ
library(masteringmetrics)
# ë°ì´í„° ë¡œë“œ
data("mlda", package = "masteringmetrics")
```
:::

::: {.column width="50%"}
```{r, echo = FALSE}
mlda %>%
  select(agecell, all, internal, external,
         alcohol, homicide, suicide) %>%
  head()
```
:::
:::::

-   ì´ ë°ì´í„°ì…‹ì€ **19\~23ì„¸ ì—°ë ¹ ê·¸ë£¹(`agecell`)**ì— ëŒ€í•œ **ì´ ì‚¬ë§ë¥ **ê³¼ **ì‚¬ë§ ì›ì¸ë³„ ì‚¬ë§ë¥ **ì„ í¬í•¨í•¨.

------------------------------------------------------------------------

## ì ˆë‹¨ì ì—ì„œì˜ ê¸‰ê²©í•œ ë¶ˆì—°ì†ì„±

```{r, echo = FALSE, eval = TRUE, fig.height = 4.75, fig.width = 10}
mlda <- mlda %>%
  mutate(over21 = (agecell >= 21))

rdd_run <- mlda %>%
  ggplot(aes(x = agecell, y = over21, color = over21)) +
  geom_point(size = 4, alpha = 0.8) +
  geom_vline(xintercept = 21, linetype = "longdash") +
  labs(x = "ë‚˜ì´", y = "ë²•ì  ìŒì£¼ ê°€ëŠ¥ ì—¬ë¶€") +
  scale_color_viridis_d() +
  theme_bw(base_size = 14) + theme(legend.position="none")
rdd_run
```

-   ì ˆë‹¨ì ì—ì„œ **ì²˜ì¹˜ í™•ë¥ ì´ 0ì—ì„œ 1ë¡œ ê¸‰ê²©íˆ ì¦ê°€**í•¨.

------------------------------------------------------------------------

## ì ˆë‹¨ì ì—ì„œì˜ ì‹œê°ì  ê°•ì¡°

```{r, echo = FALSE, eval = TRUE, fig.height = 4.75, fig.width = 10}
rdd_run +
  annotate("rect", xmin = 20.5, xmax = 21.5, ymin = -Inf, ymax = Inf, alpha = .2) +
  annotate("rect", xmin = 21 - 1/12, xmax = 21 + 1/12, ymin = -Inf, ymax = Inf, alpha = .4) +
  geom_point(size = 4, alpha = 0.8) +
  geom_vline(xintercept = 21, linetype = "longdash")
```

------------------------------------------------------------------------

## ì ˆë‹¨ì ì—ì„œì˜ ì‹œê°ì  ê°•ì¡°

```{r, echo = FALSE, eval = TRUE, fig.height = 4.75, fig.width = 10}
rdd_run +
  annotate("rect", xmin = 20.5, xmax = 21.5, ymin = -Inf, ymax = Inf, alpha = .2) +
  annotate("rect", xmin = 21 - 1/12, xmax = 21 + 1/12, ymin = -Inf, ymax = Inf, alpha = .4) +
  geom_point(size = 4, alpha = 0.8) +
  geom_vline(xintercept = 21, linetype = "longdash") +
  scale_x_continuous(breaks = c(21 - 6/12, 21 - 3/12, 21, 21 + 3/12, 21 + 6/12),
                     labels = c("- 6ê°œì›”", "- 3ê°œì›”", "21", "+ 3ê°œì›”", "+ 6ê°œì›”"),
                     minor_breaks = seq(from = 21 - 7/12, to = 21 + 7/12, by = 1/12),
                     lim = c(21 - 7/12, 21 + 7/12))
```

------------------------------------------------------------------------

## RDD í”„ë ˆì„ì›Œí¬

-   ***ì²˜ì¹˜ ë³€ìˆ˜ (Treatment Variable)***: $D_a$

    -   $D_a = 1$ (ê°œì¸ì´ 21ì„¸ ì´ìƒì´ë©´ ì²˜ì¹˜)

    -   $D_a = 0$ (ê°œì¸ì´ 21ì„¸ ë¯¸ë§Œì´ë©´ ì²˜ì¹˜ ì—†ìŒ)

    -   $D_a$ëŠ” ê°œì¸ì˜ ë‚˜ì´ $a$ì˜ í•¨ìˆ˜ì´ë©°, ì´ëŠ” ***ì—°ì† ë³€ìˆ˜ (Running Variable)***ì„.

-   ***ì ˆë‹¨ê°’ (Cutoff)***: ë²•ì  ìŒì£¼ ê°€ëŠ¥ ì—°ë ¹ì¸ 21ì„¸ê°€ ì²˜ì¹˜ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ì¤€ì„ ê²°ì •í•¨. $$
    D_a = \begin{cases}
    1 \quad \text{if } a \geq 21 \\
    0 \quad \text{if } a < 21
    \end{cases}
    $$

***RD ì„¤ê³„ì˜ í•µì‹¬ íŠ¹ì§•***

1.  ì²˜ì¹˜ ìƒíƒœëŠ” **ê²°ì •ë¡ ì (deterministic)** í•¨ìˆ˜ì´ë©°, ì²˜ì¹˜ í• ë‹¹ ê·œì¹™ì„ ì•Œê³  ìˆìŒ.
2.  ì²˜ì¹˜ ìƒíƒœëŠ” **ë¶ˆì—°ì†ì (discontinuous)** í•¨ìˆ˜ì´ë©°, íŠ¹ì • ì ˆë‹¨ê°’ì´ ì¡´ì¬í•¨.

------------------------------------------------------------------------

## Task 1 {background-color="#ffebf0"}

::: {style="position: absolute; top: -30px; right: 10px; font-size: 0.8em;"}
`r countdown(minutes = 10, top = 0)`
:::

1.  [Carpenterì™€ Dobkinì˜ ë°ì´í„°]ì˜ ì½”ë“œë¥¼ ë”°ë¼ ë°ì´í„°ì…‹ì„ ë¶ˆëŸ¬ì˜¤ë¼. ì—°ë ¹ ì…€(age cell)ì˜ ê°œìˆ˜ëŠ” ëª‡ ê°œì¸ê°€?

2.  21ì„¸ ì´ìƒì¸ ê°œì¸ì„ ìœ„í•œ ë”ë¯¸ ë³€ìˆ˜(dummy variable)ë¥¼ ìƒì„±í•˜ë¼.

3.  ì „ì²´ ì‚¬ë§ë¥ (`all`)ì„ ë‚˜ì´(`agecell`)ì˜ í•¨ìˆ˜ë¡œ ë‚˜íƒ€ë‚´ëŠ” ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê³ , 21ì„¸ ì´ìƒê³¼ ë¯¸ë§Œì„ ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ êµ¬ë¶„í•˜ë¼. ëˆˆì— ë„ëŠ” íŠ¹ì§•ì´ ìˆëŠ”ê°€?

4.  ê·¸ë˜í”„ì— íšŒê·€ì„ ì„ ì¶”ê°€í•˜ë¼. ì–´ë–¤ íŒ¨í„´ì´ ê´€ì°°ë˜ëŠ”ê°€?

5.  ë™ì¼í•œ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ ìë™ì°¨ ì‚¬ê³  ê´€ë ¨(`mva`) ë° ì•Œì½”ì˜¬ ê´€ë ¨(`alcohol`) ì‚¬ë§ë¥ ì„ ë‚˜ì´ì˜ í•¨ìˆ˜ë¡œ ë‚˜íƒ€ë‚´ë¼.



---

## ì‹œê°ì  ë¶„ì„: ì „ì²´ ì‚¬ë§ë¥ 

```{r, echo = FALSE, eval = TRUE, fig.height = 5, fig.width = 10}
rdd_plot <- mlda %>%
  ggplot(aes(x = agecell, y = all, color = over21)) +
  geom_point(size = 4) +
  geom_vline(xintercept = 21, linetype = "longdash") +
  labs(x = "Age",
       y = "Death rate from all causes (per 100,000)",
       color = NULL) +
  scale_colour_viridis_d(aesthetics = c("colour", "fill"), labels = c("FALSE" = "Control", "TRUE" = "Treatment")) +
  theme_bw(base_size = 14) +
  theme(legend.position="none")
rdd_plot
```

---

## ì‹œê°ì  ë¶„ì„: ì „ì²´ ì‚¬ë§ë¥ 

```{r, echo = FALSE, eval = TRUE, fig.height = 5, fig.width = 10}
library(broom)
all_fit <- augment(lm(all ~ agecell + over21, mlda))

rdd_plot_line <- rdd_plot +
  geom_line(data = all_fit %>% filter(agecell < 21), aes(x = agecell, y = .fitted), color = viridis_pal()(2)[1], size = 2) +
  geom_line(data = all_fit %>% filter(agecell >= 21), aes(x = agecell, y = .fitted), color = viridis_pal()(2)[2], size = 2) +
labs(fill = NULL)
rdd_plot_line
```

---

## ì‹œê°ì  ë¶„ì„: ì „ì²´ ì‚¬ë§ë¥ 

```{r, echo = FALSE, eval = TRUE, fig.height = 5, fig.width = 10}
bracketsGrob <- function(...){
l <- list(...)
e <- new.env()
e$l <- l
  grid:::recordGrob(  {
    do.call(grid.brackets, l)
  }, e)
}

b1 <- bracketsGrob(21, all_fit$.fitted[all_fit$agecell < 21 & all_fit$agecell > 20.9], 21, all_fit$.fitted[all_fit$agecell > 21 & all_fit$agecell <= 21.1],
                   h = 0.75, lwd=1.5, col="black")

rdd_plot_line_brack <- rdd_plot_line +
  annotation_custom(b1,xmin= 0, xmax=1, ymin=0, ymax=1) +
  annotate("text", x = 20.65, y = 96, label = "Treatment\nEffect", colour = "black", size = 5)
rdd_plot_line_brack
```

---

## ì‹œê°ì  ë¶„ì„: ì „ì²´ ì‚¬ë§ë¥ 

```{r, echo = FALSE, eval = TRUE, fig.height = 5, fig.width = 10}
bracketsGrob <- function(...){
l <- list(...)
e <- new.env()
e$l <- l
  grid:::recordGrob(  {
    do.call(grid.brackets, l)
  }, e)
}

all_fit_2 <- augment(lm(all ~ agecell + over21, mlda %>% filter(agecell >= 20.4 & agecell <= 21.6)))

b1 <- bracketsGrob(21, all_fit_2$.fitted[all_fit_2$agecell < 21 & all_fit_2$agecell > 20.9], 21, all_fit_2$.fitted[all_fit_2$agecell > 21 & all_fit_2$agecell <= 21.1],
                   h = 0.75, lwd=1.5, col="black")

rdd_plot +
  geom_line(data = all_fit_2 %>% filter(agecell < 21), aes(x = agecell, y = .fitted), color = viridis_pal()(2)[1], size = 2) +
  geom_line(data = all_fit_2 %>% filter(agecell >= 21), aes(x = agecell, y = .fitted), color = viridis_pal()(2)[2], size = 2) +
  labs(fill = NULL) +
  annotation_custom(b1,xmin= 0, xmax=1, ymin=0, ymax=1) +
  annotate("text", x = 20.9, y = 97.2, label = "Treatment\nEffect", colour = "black", size = 5) +
  scale_x_continuous(breaks = c(21 - 6/12, 21 - 3/12, 21, 21 + 3/12, 21 + 6/12),
                     labels = c("- 6 months", "- 3 months", "21", "+ 3 montsh", "+ 6 months"),
                     minor_breaks = seq(from = 21 - 7/12, to = 21 + 7/12, by = 1/12),
                     lim = c(21 - 7/12, 21 + 7/12))
```

---


## RDDì˜ êµ­ì†Œ í‰ê·  ì²˜ì¹˜ íš¨ê³¼ (Local Average Treatment Effect, LATE)

- RD ì¶”ì •ëŸ‰ì€ **êµ­ì†Œ í‰ê·  ì²˜ì¹˜ íš¨ê³¼(LATE)**ì„.

- ì´ëŠ” ì—°ì† ë³€ìˆ˜ì˜ **ì ˆë‹¨ê°’ ì£¼ë³€ì—ì„œë§Œ** ì²˜ì¹˜ $D$ê°€ ê²°ê³¼ ë³€ìˆ˜ $Y$ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë³´ì—¬ì¤Œ.

- ***ì™¸ì  íƒ€ë‹¹ì„±(external validity) ì œí•œ*** $\rightarrow$ ì „ì²´ ëª¨ì§‘ë‹¨ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì¼ë°˜í™”í•  ìˆ˜ ì—†ìŒ.

- 21ì„¸ ìŒì£¼ ì œí•œ ì—°ë ¹ì„ í™œìš©í•œ RDD ë¶„ì„ì€ **ì´ ì œí•œì´ ì‚¬ë§ë¥ ì— ë¯¸ì¹˜ëŠ” íš¨ê³¼**ë§Œ ì¸¡ì •í•  ìˆ˜ ìˆìœ¼ë©°, ì¼ë°˜ì ì¸ ì•Œì½”ì˜¬ ì†Œë¹„ì˜ íš¨ê³¼ë¥¼ ì¶”ì •í•  ìˆ˜ ì—†ìŒ.

- ì–‘ì  ì‹¤ì¦ ë¶„ì„ì—ì„œ ë„ì¶œë˜ëŠ” ëª¨ë“  ê²°ê³¼ëŠ” ë³¸ì§ˆì ìœ¼ë¡œ êµ­ì†Œì ì¸ ì„±ê²©ì„ ê°€ì§„ë‹¤ê³  ì£¼ì¥í•  ìˆ˜ ìˆìŒ.



# Estimation

---

## ì¶”ì • (Estimation)

- **ëª©ì :** ì ˆë‹¨ê°’ì—ì„œ ***ë‘ íšŒê·€ì„  ì‚¬ì´ì˜ ì°¨ì´(gap)***ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒ.

- ê°€ì¥ ê°„ë‹¨í•œ í˜•íƒœì˜ íšŒê·€ ëª¨í˜•ì€ ë‹¤ìŒê³¼ ê°™ìŒ:
  $$
  DEATHRATE_a = \alpha + \delta D_a + \beta a + \varepsilon_i,
  $$
  ì—¬ê¸°ì„œ $DEATHRATE_a$ëŠ” ì—°ë ¹ $a$ì—ì„œì˜ ì‚¬ë§ë¥ , $D_a$ëŠ” ì²˜ì¹˜ ë”ë¯¸ ë³€ìˆ˜, $a$ëŠ” ë‚˜ì´(21ì„¸ ìƒì¼ë¶€í„°ì˜ ê°œì›” ìˆ˜)ì„.

  - $\delta$ëŠ” **21ì„¸ ì´ìƒê³¼ ë¯¸ë§Œ ì‚¬ì´ì˜ ì‚¬ë§ë¥  ì°¨ì´**ë¥¼ ë‚˜íƒ€ëƒ„.

- RDD ì¶”ì •ëŸ‰ì€ $a = 21$ì—ì„œ ì¡°ê±´ë¶€ ê¸°ëŒ“ê°’ í•¨ìˆ˜ì˜ ë¶ˆì—°ì†ì„±ì„ ì´ìš©í•¨:
  $$
  \underbrace{\lim_{c \to 21^+} \mathbb{E}[DEATHRATE_a|a = c]}_{\alpha + \delta} - \underbrace{\lim_{c \to 21^-} \mathbb{E}[DEATHRATE_a|a = c]}_{\alpha} = \delta
  $$

---

## Task 2 {background-color="#ffebf0"}

::: {style="position: absolute; top: -30px; right: 10px; font-size: 0.8em;"}
`r countdown(minutes = 5, top = 0)`
:::


1. ëª¨ë“  ì‚¬ë§ ì›ì¸ì— ëŒ€í•´ ë‹¤ìŒ íšŒê·€ ëª¨í˜•ì„ ì¶”ì •í•˜ë¼.
   $$
   DEATHRATE_a = \alpha + \delta D_a + \beta a + \varepsilon_i,
   $$
   - RDD ì¶”ì • ê³„ìˆ˜ê°€ ê·¸ë˜í”„ì  ë¶„ì„ê³¼ ì¼ì¹˜í•˜ëŠ”ê°€?

2. ê° ê³„ìˆ˜ë¥¼ ì–´ë–»ê²Œ í•´ì„í•  ìˆ˜ ìˆëŠ”ê°€?

3. ë²•ì  ìŒì£¼ ì ‘ê·¼ì´ ì‚¬ë§ë¥ ì— ë¯¸ì¹˜ëŠ” ì¸ê³¼ì  íš¨ê³¼ëŠ” ë¬´ì—‡ì¸ê°€?


---


## Estimation #1: ë‹¨ìˆœ ì„ í˜• ëª¨í˜•ì„ ì´ìš©í•œ ì¶”ì •

$$DEATHRATE_a = \alpha + \delta D_a + \beta a + \varepsilon_a,$$

:::: columns

::: {.column width="50%"}
```{r, eval = FALSE}
mlda <- mlda %>%
  mutate(over21 = (agecell >= 21),
         agecell_21 = agecell - 21)
rdd <- lm(all ~ agecell_21 + over21, mlda)

library(broom)
tidy(rdd)
```
:::

::: {.column width="50%"}
```{r, echo = FALSE}
mlda <- mlda %>%
  mutate(over21 = (agecell >= 21),
         agecell_21 = agecell - 21)
rdd <- lm(all ~ agecell_21 + over21, mlda)

library(broom)
tidy(rdd)
```
:::

::::

***í•´ì„ (Interpretation):***

- í‰ê· ì ìœ¼ë¡œ, ë²•ì  ìŒì£¼ ê°€ëŠ¥ ì—°ë ¹(MLDA)ì€ ì „ì²´ ì‚¬ë§ë¥ ì„ **7.66 í¼ì„¼íŠ¸í¬ì¸íŠ¸ ì¦ê°€**ì‹œí‚´.

- ì´ëŠ” ìƒë‹¹í•œ íš¨ê³¼ì´ë©°, 19ì„¸ë¶€í„° 22ì„¸ê¹Œì§€ ê°œì¸ì˜ í‰ê·  ì‚¬ë§ë¥ ì€ ë‹¤ìŒê³¼ ê°™ìŒ:

```{r}
mean(mlda$all, na.rm = TRUE)
```

---


## ì¶”ì • ìƒ ì´ìŠˆ

- ***í•¨ìˆ˜ í˜•íƒœ (Functional Form)***ì˜ ì„ íƒì´ ë§¤ìš° ì¤‘ìš”í•¨!

  - $\Rightarrow$ ì§€ë‚˜ì¹˜ê²Œ ë‹¨ìˆœí•œ ëª¨í˜•ì€ **ë¹„ì„ í˜•ì„±(nonlinearity)ì„ ì²˜ì¹˜ íš¨ê³¼ë¡œ ì˜¤ì¸í•  ìœ„í—˜**ì´ ìˆìŒ.
  
  - $\Rightarrow$ ë°˜ëŒ€ë¡œ, ë„ˆë¬´ ë³µì¡í•œ ëª¨í˜•ì€ **ì •í™•ì„±ì„ ë–¨ì–´ëœ¨ë¦¬ê³ (overfitting) ê³¼ì í•©(overfitting) ìœ„í—˜**ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŒ.


---

## ì‹œë®¬ë ˆì´ì…˜ - ì„ í˜• ê´€ê³„ì™€ ëª…í™•í•œ ë¶ˆì—°ì†ì„±

```{r, echo = FALSE, fig.height = 4.5, fig.width = 10}
set.seed(1234)

  # parameters
cutoff = 0.5
alpha = 0.2 # intercept
delta = 0.4 # jump at cutoff
beta = 2 # slope
nsim = 150 # number of simulated observations

  # running variable
x = runif(n = nsim,
          min = 0,
          max = 1)

  # treatment variable
D = if_else(x > cutoff, TRUE, FALSE)

  # error term
u = rnorm(n = nsim, mean = 0, sd = .1)

  # outcome variable
Y = alpha + beta * x + D*delta + u

  # create tibble
rdd_sim = tibble(running = x,
                 treatment_dum = D,
                 outcome = Y)
  
  # plot
rdd_lin <- ggplot(rdd_sim,
       aes(x = running, y = outcome, color = treatment_dum)) +
  geom_point(size = 3, alpha = 0.75) +
  stat_smooth(method = "lm", se = FALSE) +
  ylim(0,3) +
  labs(x = "Running variable",
       y = "Outcome variable",
       colour = NULL) +
  scale_colour_viridis_d(breaks=c("FALSE", "TRUE"), labels = c("Not Treated", "Treated")) +
  theme_bw(base_size = 14) + theme(legend.position="top")
rdd_lin
```


$$outcome_i = \alpha + \delta treatment_i + \beta running_i + e_i,$$

---

## ì‹œë®¬ë ˆì´ì…˜ - ì„ í˜• ê´€ê³„ì™€ ëª…í™•í•œ ë¶ˆì—°ì†ì„±

```{r, echo = FALSE, fig.height = 4.5, fig.width = 10}
bracketsGrob <- function(...){
l <- list(...)
e <- new.env()
e$l <- l
  grid:::recordGrob(  {
    do.call(grid.brackets, l)
  }, e)
}

b1 <- bracketsGrob(0.50, 1.20, 0.50, 1.63, h = 0.2, lwd=1.5, col="black")

rdd_lin +
  annotation_custom(b1,xmin= 0, xmax=1, ymin=0, ymax=1) +
  annotate("text", x = 0.46, y = 1.45, label = "delta", colour = "#d90502", parse = T, size = 8)
```

$$outcome_i = \alpha + \color{#d90502}\delta treatment_i + \beta running_i + e_i,$$

---

## ì‹œë®¬ë ˆì´ì…˜ - ë¹„ì„ í˜• ê´€ê³„ì™€ ëª…í™•í•œ ë¶ˆì—°ì†ì„±

```{r, echo = FALSE, fig.height = 4.5, fig.width = 10}
set.seed(1234)

  # parameters
cutoff = 0.5
alpha = 1.5 # intercept
delta = 0.4 # jump at cutoff
beta = -8 # slope
beta_2 = 25
beta_3 = -17
nsim = 150 # number of simulated observations

  # running variable
x = runif(n = nsim,
          min = 0,
          max = 1)

  # treatment variable
D = if_else(x > cutoff, TRUE, FALSE)

  # error term
u = rnorm(n = nsim, mean = 0, sd = .1)

  # outcome variable
Y = alpha + beta * x + beta_2 * x^2 + beta_3 * x^3 + D*delta + u

  # create tibble
rdd_sim = tibble(running = x,
                 treatment_dum = D,
                 outcome = Y)

  # plot
rdd_quad <- ggplot(rdd_sim,
       aes(x = running, y = outcome, color = treatment_dum)) +
  geom_point(size = 3, alpha = 0.75) +
  stat_smooth(method = "lm",
              formula = y ~ x + I(x^2),
              se = FALSE) +
  geom_vline(xintercept = 0.5, linetype = "longdash") +
  ylim(0,3) +
  labs(x = "Running variable", y = "Outcome variable", colour = "") +
  scale_colour_viridis_d(breaks=c("FALSE", "TRUE"), labels = c("Not Treated", "Treated")) +
  theme_bw(base_size = 14) + theme(legend.position="top")
rdd_quad
```

$$outcome_i = \alpha + \delta treatment_i + \beta_1 running_i + \color{#d90502}{\beta_2 running_i^2} + e_i,$$

---

## ì‹œë®¬ë ˆì´ì…˜ - ë¹„ì„ í˜• ê´€ê³„ì™€ ëª…í™•í•œ ë¶ˆì—°ì†ì„±

```{r, echo = FALSE, fig.height = 4.5, , fig.width = 10}
bracketsGrob <- function(...){
l <- list(...)
e <- new.env()
e$l <- l
  grid:::recordGrob(  {
    do.call(grid.brackets, l)
  }, e)
}

b1 <- bracketsGrob(0.50, 1.68, 0.50, 2.05, h = 0.2, lwd=1.5, col="black")

rdd_quad +
  annotation_custom(b1,xmin= 0, xmax=1, ymin=0, ymax=1) +
  annotate("text", x = 0.46, y = 1.865, label = "delta", colour = "#d90502", parse = T, size = 8)
```

$$outcome_i = \alpha + \color{#d90502}\delta treatment_i + \beta_1 running_i + \beta_2 running_i^2 + e_i,$$

---

## ì‹œë®¬ë ˆì´ì…˜ - ì„ í˜• ê´€ê³„ì™€ ***ë¶ˆëª…í™•í•œ*** ë¶ˆì—°ì†ì„±

```{r, echo = FALSE, fig.height = 4.5, fig.width = 10}
set.seed(123)

  # parameters
cutoff = 0.5
alpha = 2.5 # intercept
beta_1 = 2.5 # slope
beta_2 = 0.5 # slope 2
power = 7
nsim = 150 # number of simulated observations

  # running variable
x = runif(n = nsim,
          min = 0,
          max = 1)

  # treatment variable
D = if_else(x > cutoff, TRUE, FALSE)

  # error term
u = rnorm(n = nsim, mean = 0, sd = .1)

  # outcome variable
Y = alpha + (1 - alpha) / (1 + (x/beta_2)^power) + u

  # without error term
Y_true = alpha + (1 - alpha) / (1 + (x/beta_2)^power)

  # create tibble
rdd_sim = tibble(running = x,
                 treatment_dum = D,
                 outcome = Y,
                 true = Y_true)

  # plot
rdd_nodisc <- ggplot(rdd_sim,
       aes(x = running, y = outcome, color = treatment_dum)) +
  geom_point(size = 3, alpha = 0.75) +
  geom_line(aes(x = running, y = true), colour = "black", linetype = "dotted") +
  stat_smooth(method = "lm",
              formula = y ~ x,
              se = FALSE) +
  geom_vline(xintercept = 0.5, linetype = "longdash") +
  ylim(0,3) +
  labs(x = "Running variable", y = "Outcome variable", colour = "") +
  scale_colour_viridis_d(breaks=c("FALSE", "TRUE"), labels = c("Not Treated", "Treated")) +
  theme_bw(base_size = 14) + theme(legend.position="top")
rdd_nodisc
```

---

## ì‹œë®¬ë ˆì´ì…˜ - ë‹¤ë¥¸ ê¸°ìš¸ê¸°

```{r, echo = FALSE, fig.height = 4.5, fig.width = 10}
set.seed(1234)

  # parameters
cutoff = 0.5
alpha = 1 # intercept
delta = 0.4 # jump at cutoff
beta = -1 # slope
gamma = 4
nsim = 150 # number of simulated observations

  # running variable
x = runif(n = nsim,
          min = 0,
          max = 1)

  # treatment variable
D = if_else(x > cutoff, TRUE, FALSE)

  # error term
u = rnorm(n = nsim, mean = 0, sd = .1)

  # outcome variable
Y = alpha + beta * (x - cutoff) + D*delta + gamma * D * (x - cutoff) + u

  # create tibble
rdd_sim = tibble(running = x,
                 treatment_dum = D,
                 outcome = Y)

  # plot
rdd_diffslope <- ggplot(rdd_sim,
       aes(x = running, y = outcome, color = treatment_dum)) +
  geom_point(size = 3, alpha = 0.75) +
  stat_smooth(method = "lm",
              formula = y ~ x,
              se = FALSE) +
  geom_vline(xintercept = 0.5, linetype = "longdash") +
  ylim(0,3) +
  labs(x = "Running variable", y = "Outcome variable", colour = "") +
  scale_colour_viridis_d(breaks=c("FALSE", "TRUE"), labels = c("Not Treated", "Treated")) +
  theme_bw(base_size = 14) + theme(legend.position="top")
rdd_diffslope
```


$$outcome_i = \alpha + \delta treatment_i + \beta (running_i - cutoff) + \\ \color{#d90502}{\gamma treatment_i * (running_i - cutoff)} + e_i,$$

---

## ì‹œë®¬ë ˆì´ì…˜ - ë‹¤ë¥¸ ê¸°ìš¸ê¸°

```{r, echo = FALSE, fig.height = 4.5, fig.width = 10}
bracketsGrob <- function(...){
l <- list(...)
e <- new.env()
e$l <- l
  grid:::recordGrob(  {
    do.call(grid.brackets, l)
  }, e)
}

b1 <- bracketsGrob(0.50, 0.99, 0.50, 1.46, h = 0.2, lwd=1.5, col="black")

rdd_diffslope +
  annotation_custom(b1,xmin= 0, xmax=1, ymin=0, ymax=1) +
  annotate("text", x = 0.46, y = 1.225, label = "delta", colour = "#d90502", parse = T, size = 8)
```

$$outcome_i = \alpha + \color{#d90502}\delta treatment_i + \beta (running_i - cutoff) + \\ \gamma treatment_i * (running_i - cutoff) + e_i,$$

---

## ì ì ˆí•œ í•¨ìˆ˜ í˜•íƒœ ì„ íƒ ë°©ë²•

- ë°ì´í„°ë¥¼ ***ì‹œê°í™”(visualize)***í•˜ëŠ” ê²ƒì´ í•„ìˆ˜ì ì„!

- ë‹¤ì–‘í•œ ëª¨í˜•ì—ì„œ ì¶”ì •ëœ ê³„ìˆ˜ ê°’ì´ í¬ê²Œ ë³€í•˜ì§€ ì•Šì•„ì•¼ í•¨.

- ê²°ê³¼ ë³€ìˆ˜ì™€ ì—°ì† ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ê°€ ë¹„ì„ í˜•ì¼ ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ”ê°€? ì ˆë‹¨ê°’ ê·¼ì²˜ì—ì„œ ê´€ê³„ê°€ ë‹¬ë¼ì§ˆ ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ”ê°€?

- [Gelman and Imbens (2019)](https://www.tandfonline.com/doi/abs/10.1080/07350015.2017.1366909), "Why High-Order Polynomials Should Not Be Used in Regression Discontinuity Designs":  
  *"ì—°êµ¬ìë“¤ì´ ì§€ì—­ ì„ í˜•(local linear) ë˜ëŠ” ì´ì°¨ ë‹¤í•­ì‹(quadratic polynomials) ë˜ëŠ” ë‹¤ë¥¸ ë¶€ë“œëŸ¬ìš´ í•¨ìˆ˜(smooth functions)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì¶”ì •ëŸ‰ì„ ì‚¬ìš©í•  ê²ƒì„ ê¶Œì¥í•¨."*

---

## ì˜ˆì œë¡œ ëŒì•„ê°€ê¸°: ë¹„ì„ í˜•ì„± / ë‹¤ë¥¸ ê¸°ìš¸ê¸°

```{r, echo = FALSE, eval = TRUE, fig.height = 4.5, fig.width = 10}
all_nonlin_fit <- augment(lm(all ~ agecell_21*over21 + I(agecell_21^2)*over21, mlda))

rdd_plot
```

---

## ì˜ˆì œë¡œ ëŒì•„ê°€ê¸°: ë¹„ì„ í˜•ì„± / ë‹¤ë¥¸ ê¸°ìš¸ê¸°

```{r, echo = FALSE, eval = TRUE, fig.height = 4.5, fig.width = 10}
all_nonlin_fit <- augment(lm(all ~ agecell_21*over21 + I(agecell_21^2)*over21, mlda))

rdd_plot_line +
  geom_line(data = all_nonlin_fit %>% filter(agecell_21 < 0), aes(x = agecell_21 + 21, y = .fitted), color = viridis_pal()(2)[1], linetype = "dashed", size = 1.25) +
  geom_line(data = all_nonlin_fit %>% filter(agecell_21 >= 0), aes(x = agecell_21 + 21, y = .fitted), color = viridis_pal()(2)[2], linetype = "dashed", size = 1.25)
```

- ë‘ ëª¨í˜•ì—ì„œ ì„  ê°„ì˜ ì°¨ì´ëŠ” ëŒ€ëµì ìœ¼ë¡œ ë™ì¼í•¨.


---

## Task 3 {background-color="#ffebf0"}

::: {style="position: absolute; top: -30px; right: 10px; font-size: 0.8em;"}
`r countdown(minutes = 15, top = 0)`
:::

1. ëª¨ë“  ì‚¬ë§ ì›ì¸ì— ëŒ€í•´ ë‹¤ìŒ **ì´ì°¨(quadratic) íšŒê·€ ëª¨í˜•**ì„ ì¶”ì •í•˜ë¼. RDD ê³„ìˆ˜ê°€ ì„ í˜• ëª¨í˜•ê³¼ ë‹¤ë¥¸ê°€?
   $$
   DEATHRATE_a = \alpha + \delta D_a + \beta a + \beta a^2 + \varepsilon_a,
   $$

2. ì ˆë‹¨ì  ì–‘ìª½ì—ì„œ ê¸°ìš¸ê¸°ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ëŠ” íšŒê·€ ëª¨í˜•ì€ ë‹¤ìŒê³¼ ê°™ìŒ:
   $$
   DEATHRATE_a = \alpha + \delta D_a + \beta (a - 21) + \gamma D_a * (a - 21) + \varepsilon_a,
   $$
   - ì™œ `cutoff`ì—ì„œ `running_i`ë¥¼ ë¹¼ì•¼ í•˜ëŠ”ê°€? (íŒíŠ¸: $\mathbb{E}(DEATHRATE_a|a=21)$ì„ ê³„ì‚°í•´ë³´ë¼.)
   - ì‚¬ë§ë¥ ê³¼ ì—°ë ¹ ê°„ì˜ ê´€ê³„ê°€ 21ì„¸ì—ì„œ ë³€í™”í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ”ê°€?
   - ì´ ëª¨í˜•ì„ ì¶”ì •í•˜ë¼. ë‹¤ë¥¸ ëª¨í˜•ì—ì„œ ì¶”ì •í•œ RDD ê³„ìˆ˜ì™€ ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ê°€?

3. ë‹¤ìŒ ì‚¬ë§ ì›ì¸ì— ëŒ€í•´ ìœ„ì˜ ëª¨í˜•ë“¤(ì„ í˜•, ì´ì°¨, ê¸°ìš¸ê¸° ì°¨ì´ ëª¨í˜•)ì„ ë‹¤ì‹œ ì‹¤í–‰í•˜ë¼:
   - ìë™ì°¨ ì‚¬ê³  (`mva`)
   - ì•Œì½”ì˜¬ ê´€ë ¨ (`alcohol`)
   - ë‚´ë¶€ì  ì›ì¸ (`internal`)


---

## íšŒê·€ë¶„ì„ ê²°ê³¼ ê·¸ë˜í”„ë¡œ í‘œí˜„

```{r, echo = FALSE, eval = TRUE, fig.height = 5, fig.width = 10}
mlda_long <- mlda %>%
    select(-contains("fitted")) %>%        # drop "fitted" variables
    pivot_longer(cols = -c(agecell,over21),          # column to not reshape
                 names_to = "death_cause", # new variable containing death causes
                 values_to = "death_rate") %>% # new variable containing death rates by cause
  filter(death_cause %in% c("all","mva","internal"))

rdd_plot <- mlda_long %>%
  ggplot(aes(x = agecell, y = death_rate, color = over21)) + geom_point() +
    geom_smooth(mapping = aes(group = over21), se = FALSE, method = "lm",
              formula = y ~ x) +
  geom_vline(xintercept = 21, linetype = "longdash") +
  labs(x = "Age", y = "Death rate (per 100,000)") +
  scale_colour_viridis_d() +
  theme_bw(base_size = 16) + theme(legend.position="none") +
  facet_grid(rows = vars(death_cause), scales = "free_y")
rdd_plot
```

---

## ë¹„ëª¨ìˆ˜ì  ì¶”ì • (Nonparametric Estimation)

- ì ˆë‹¨ê°’(cutoff) ê·¼ì²˜ì˜ ê´€ì¸¡ì¹˜ì— ë” ë§ì€ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•¨.

***ë‘ ê°€ì§€ ì„¤ì •:***

1. ì–¼ë§ˆë‚˜ ë” ë§ì€ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•  ê²ƒì¸ê°€?
   - $\Rightarrow$ ì„ íƒí•œ ***ì»¤ë„(kernel)***ì— ë”°ë¼ ë‹¬ë¼ì§.

2. ì ˆë‹¨ê°’ì—ì„œ ì–¼ë§ˆë‚˜ ë–¨ì–´ì§„ ê´€ì¸¡ì¹˜ë¥¼ ì œì™¸í•  ê²ƒì¸ê°€?
   - $\Rightarrow$ ì„ íƒí•œ ***ëŒ€ì—­í­(bandwidth)***ì— ë”°ë¼ ë‹¬ë¼ì§.


- ë‹¤í–‰íˆë„ `R`ì—ëŠ” ì´ëŸ¬í•œ ì„¤ì •ì„ ìµœì í™”í•´ì£¼ëŠ” íŒ¨í‚¤ì§€ê°€ ì¡´ì¬í•¨: `rdrobust`.

---


# Identifying Assumptions

---

## RDD ê°€ì • (RDD Assumptions)

> ***í•µì‹¬ ê°€ì •(Key Assumption)***: ***ì ì¬ì  ê²°ê³¼(Potential Outcomes)ëŠ” ì ˆë‹¨ê°’ì—ì„œ ë§¤ë„ëŸ¬ì›Œì•¼ í•¨.***

$\Rightarrow$ ì²˜ì¹˜ í• ë‹¹ ë³€ìˆ˜(assignment variable)ëŠ” ì¡°ì‘ë  ìˆ˜ ì—†ì–´ì•¼ í•¨!

- ê³µì‹ì ìœ¼ë¡œ:
  $$
  \lim_{r \to c+} \mathbb{E}[Y_i^d|r] = \lim_{r \to c-} \mathbb{E}[Y_i^d|r], d \in \{0,1\}
  $$

- ì ˆë‹¨ê°’ ë°”ë¡œ ì•„ë˜ì™€ ë°”ë¡œ ìœ„ì˜ ëª¨ì§‘ë‹¨ì€ ë¶ˆì—°ì†ì ìœ¼ë¡œ ë‹¬ë¼ì„œëŠ” ì•ˆ ë¨.

- ë§Œì•½ ê°œì¸ì´ ì ˆë‹¨ê°’ì„ ì•Œê³  ìˆê³ , ì´ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤ë©´ ì´ ê°€ì •ì´ ìœ„ë°°ë¨.

  - ë‹¨ìˆœíˆ ì ˆë‹¨ê°’ì„ ì•„ëŠ” ê²ƒ ìì²´ëŠ” ë¬¸ì œë˜ì§€ ì•Šìœ¼ë©°, **ì—°ì† ë³€ìˆ˜ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥**ì´ ê°€ì •ì„ ìœ„ë°°í•˜ëŠ” ìš”ì†Œì„.

---

## RDD ê°€ì • (RDD Assumptions)

> ***í•µì‹¬ ê°€ì •(Key Assumption)***: ***ì ì¬ì  ê²°ê³¼ëŠ” ì ˆë‹¨ê°’ì—ì„œ ë§¤ë„ëŸ¬ì›Œì•¼ í•¨.***

ì´ ê°€ì •ì´ ì¶©ì¡±ë˜ë©´ ë‹¤ìŒê³¼ ê°™ìŒ:

$$
\begin{align}
&\lim_{r \to c^+} \mathbb{E}[Y_i | R_i = r] - \lim_{r \to c^-} \mathbb{E}[Y_i | R_i = r] \\
= &\lim_{r \to c^+} \mathbb{E}[Y_i^1 | R_i = r] - \lim_{r \to c^-} \mathbb{E}[Y_i^0 | R_i = r] \\
= &\mathbb{E}[Y_i^1 | R_i = c] - \mathbb{E}[Y_i^0 | R_i = c] \\
= &\mathbb{E}[Y_i^1 - Y_i^0 | R_i = c] \\
\end{align}
$$

---

## RDD ê°€ì • (RDD Assumptions)

> ***í•µì‹¬ ê°€ì •(Key Assumption)***: ***ì ì¬ì  ê²°ê³¼ëŠ” ì ˆë‹¨ê°’ì—ì„œ ë§¤ë„ëŸ¬ì›Œì•¼ í•¨.***

ì´ ê°€ì •ì´ ì¶©ì¡±ë˜ë©´ ë‹¤ìŒê³¼ ê°™ìŒ:

$$
\begin{align}
&\lim_{c \to 21^+} \mathbb{E}[Y_i | a_i = c] - \lim_{a \to 21^-} \mathbb{E}[Y_i | a_i = c] \\
= &\lim_{c \to 21^+} \mathbb{E}[Y_i^1 | a_i = c] - \lim_{c \to 21^-} \mathbb{E}[Y_i^0 | a_i = c] \\
= &\mathbb{E}[Y_i^1 | a_i = 21] - \mathbb{E}[Y_i^0 | a_i = 21] \\
= &\underbrace{\mathbb{E}[Y_i^1 - Y_i^0}_{\text{ATE}} | a_i = 21] \\
\end{align}
$$

---


## ì˜ˆì œ: ì¡°ì‘ì˜ ê°€ëŠ¥ì„±

[Camacho and Conover (2011)](https://pubs.aeaweb.org/doi/pdfplus/10.1257/pol.3.2.41)ì˜ ì—°êµ¬ì—ì„œ ì‚¬íšŒ ë³´ì¡° í”„ë¡œê·¸ë¨ì˜ ìê²© ê¸°ì¤€ì´ ì•Œë ¤ì§€ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ê°€?

:::: columns

::: {.column width="50%"}
```{r, echo = FALSE, out.width = "700px"}
knitr::include_graphics("../img/photos/manip_1.png")
```
:::

::: {.column width="50%"}
```{r, echo = FALSE, out.width = "700px"}
knitr::include_graphics("../img/photos/manip_2.png")
```
:::

::::

---

## ë¹„ìˆœì‘ (Noncompliance)

ì—°ì† ë³€ìˆ˜ê°€ ì²˜ì¹˜ í• ë‹¹ì„ **ì™„ì „íˆ** ê²°ì •í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´?

$\rightarrow$ ***í¼ì§€ RDD(Fuzzy RDD)***

- ì²˜ì¹˜ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ëª¨ë“  ê´€ì¸¡ì¹˜ê°€ ì‹¤ì œë¡œ ì²˜ì¹˜ë¥¼ ë°›ì§€ ì•Šë”ë¼ë„, ì²˜ì¹˜ë¥¼ ë°›ì„ í™•ë¥ ì—ëŠ” ì—¬ì „íˆ ë¶ˆì—°ì†ì„±ì´ ì¡´ì¬í•¨.

- ì²˜ì¹˜ í• ë‹¹ì´ ë¶ˆì™„ì „í•˜ê²Œ ê²°ì •ë˜ëŠ” ë¬¸ì œë„ í•´ê²° ê°€ëŠ¥í•¨.

---

## ì‹¤ì „ RDD ë¶„ì„ì„ ìœ„í•œ 5ë‹¨ê³„

ë‹¨ê³„ 1: ***ì²˜ì¹˜ í• ë‹¹ì´ ê·œì¹™ì— ì˜í•´ ê²°ì •ë˜ëŠ”ê°€?***

ë‹¨ê³„ 2: ***Sharp RDDì¸ê°€, Fuzzy RDDì¸ê°€?***

ë‹¨ê³„ 3: ***ì—°ì† ë³€ìˆ˜(running variable)ì—ì„œ ì ˆë‹¨ì ì— ë¶ˆì—°ì†ì„±ì´ ì¡´ì¬í•˜ëŠ”ê°€?***

ë‹¨ê³„ 4: ***ê²°ê³¼ ë³€ìˆ˜ì—ì„œ ì—°ì† ë³€ìˆ˜ì˜ ì ˆë‹¨ì ì—ì„œ ë¶ˆì—°ì†ì„±ì´ ì¡´ì¬í•˜ëŠ”ê°€?***

ë‹¨ê³„ 5: ***ë¶ˆì—°ì†ì„±ì˜ í¬ê¸°ëŠ” ì–´ëŠ ì •ë„ì¸ê°€?***




------------------------------------------------------------------------

## ğŸ” ì¸ê³¼ ê´€ê³„ë¥¼ ì°¾ì•„ê°€ëŠ” ê¸¸

âœ… ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ë‹¤ë£°ê¹Œ?: ì½ê¸°(Read), ì •ë¦¬(Tidy), ì‹œê°í™”(Visualize)...

âœ… ë³€ìˆ˜ê°„ ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ìš”ì•½í• ê¹Œ? ë‹¨ìˆœ / ë‹¤ì¤‘ ì„ í˜• íšŒê·€...ë¹„ì„ í˜•íšŒê·€, êµì°¨ë³€ìˆ˜...

âœ… ì¸ê³¼ ê´€ê³„(Causality)ë€ ë¬´ì—‡ì¸ê°€?

âœ… ì „ì²´ ëª¨ì§‘ë‹¨ì„ ê´€ì¸¡í•˜ì§€ ëª»í•˜ë©´ ì–´ë–»ê²Œ í• ê¹Œ? Sampling!

âœ… ìš°ë¦¬ì˜ ì—°êµ¬ ê²°ê³¼ê°€ ë‹¨ìˆœí•œ ë¬´ì‘ìœ„(Randomness) ë•Œë¬¸ì¼ ìˆ˜ë„ ìˆì„ê¹Œ? ì‹ ë¢°êµ¬ê°„ê³¼ ê°€ì„¤ê²€ì •. í†µê³„ì  ì¶”ë¡ 

ğŸš§ ***ì‹¤ì œë¡œ ì™¸ìƒì„±ì„ ì–´ë–»ê²Œ ì°¾ì•„ë‚¼ ìˆ˜ ìˆì„ê¹Œ?***: ì´ì¤‘ ì°¨ë¶„, íšŒê·€ ë¶ˆì—°ì† ì„¤ê³„

------------------------------------------------------------------------


<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

::: {style="display: flex; justify-content: center; align-items: center; height: 70vh;"}
<h2 style="color: #ff6666; text-align: center; font-family: &#39;Pacifico&#39;, cursive; font-size: 50px;">

THE END!

</h2>
:::
